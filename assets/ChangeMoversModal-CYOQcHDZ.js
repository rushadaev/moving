import{d as A,r as S,a3 as K,U as B,a4 as Z,a as R,o as P,_ as T,ar as z,a0 as q,e as w,t as J,f as G,a1 as O,Z as W,h as x,a2 as X,b as $,i as D,G as F}from"./index-C8pLlvXj.js";import{T as H}from"./Button.vue_vue_type_style_index_0_scoped_39e4a762_lang-EwgLgxLc.js";function Q(l,e,o,t){function a(n){return n instanceof o?n:new o(function(r){r(n)})}return new(o||(o=Promise))(function(n,r){function c(g){try{d(t.next(g))}catch(v){r(v)}}function p(g){try{d(t.throw(g))}catch(v){r(v)}}function d(g){g.done?n(g.value):a(g.value).then(c,p)}d((t=t.apply(l,[])).next())})}function Y(l){return l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var ee=function l(e,o){if(e===o)return!0;if(e&&o&&typeof e=="object"&&typeof o=="object"){if(e.constructor!==o.constructor)return!1;var t,a,n;if(Array.isArray(e)){if(t=e.length,t!=o.length)return!1;for(a=t;a--!==0;)if(!l(e[a],o[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===o.source&&e.flags===o.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===o.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===o.toString();if(n=Object.keys(e),t=n.length,t!==Object.keys(o).length)return!1;for(a=t;a--!==0;)if(!Object.prototype.hasOwnProperty.call(o,n[a]))return!1;for(a=t;a--!==0;){var r=n[a];if(!l(e[r],o[r]))return!1}return!0}return e!==e&&o!==o},te=Y(ee);const U="__googleMapsScriptId";var M;(function(l){l[l.INITIALIZED=0]="INITIALIZED",l[l.LOADING=1]="LOADING",l[l.SUCCESS=2]="SUCCESS",l[l.FAILURE=3]="FAILURE"})(M||(M={}));class E{constructor({apiKey:e,authReferrerPolicy:o,channel:t,client:a,id:n=U,language:r,libraries:c=[],mapIds:p,nonce:d,region:g,retries:v=3,url:b="https://maps.googleapis.com/maps/api/js",version:i}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=o,this.channel=t,this.client=a,this.id=n||U,this.language=r,this.libraries=c,this.mapIds=p,this.nonce=d,this.region=g,this.retries=v,this.url=b,this.version=i,E.instance){if(!te(this.options,E.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(E.instance.options)}`);return E.instance}E.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?M.FAILURE:this.done?M.SUCCESS:this.loading?M.LOADING:M.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,o)=>{this.loadCallback(t=>{t?o(t.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,o;if(document.getElementById(this.id)){this.callback();return}const t={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(t).forEach(n=>!t[n]&&delete t[n]),!((o=(e=window==null?void 0:window.google)===null||e===void 0?void 0:e.maps)===null||o===void 0)&&o.importLibrary||(n=>{let r,c,p,d="The Google Maps JavaScript API",g="google",v="importLibrary",b="__ib__",i=document,u=window;u=u[g]||(u[g]={});const s=u.maps||(u.maps={}),f=new Set,h=new URLSearchParams,m=()=>r||(r=new Promise((k,y)=>Q(this,void 0,void 0,function*(){var C;yield c=i.createElement("script"),c.id=this.id,h.set("libraries",[...f]+"");for(p in n)h.set(p.replace(/[A-Z]/g,I=>"_"+I[0].toLowerCase()),n[p]);h.set("callback",g+".maps."+b),c.src=this.url+"?"+h,s[b]=k,c.onerror=()=>r=y(Error(d+" could not load.")),c.nonce=this.nonce||((C=i.querySelector("script[nonce]"))===null||C===void 0?void 0:C.nonce)||"",i.head.append(c)})));s[v]?console.warn(d+" only loads once. Ignoring:",n):s[v]=(k,...y)=>f.add(k)&&m().then(()=>s[v](k,...y))})(t);const a=this.libraries.map(n=>this.importLibrary(n));a.length||a.push(this.importLibrary("core")),Promise.all(a).then(()=>this.callback(),n=>{const r=new ErrorEvent("error",{error:n});this.loadErrorCallback(r)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const o=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${o} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},o)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}const oe=A({__name:"GoogleMap",props:{height:{type:[String,Number],default:"300px"},center:{type:Object,default:()=>({lat:40.7128,lng:-74.006})},zoom:{type:Number,default:12},markers:{type:Array,default:()=>[]},showRoute:{type:Boolean,default:!1},origin:{type:Object,default:null},destination:{type:Object,default:null}},emits:["route-calculated"],setup(l,{expose:e,emit:o}){const t=l,a=o,n=void 0,r=S(null);let c=null,p=[],d=null;const g=async()=>{if(r.value)try{const f=await new E({apiKey:n,version:"weekly",libraries:["places","geometry","drawing","routes"]}).load();c=new f.maps.Map(r.value,{center:t.center,zoom:t.zoom,disableDefaultUI:!0,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]}),t.showRoute&&t.origin&&t.destination&&i(),v(f)}catch(s){console.error("Error loading Google Maps:",s)}},v=s=>{c&&(b(),t.markers.forEach(f=>{let h=f.icon;h&&h.url&&(h={...h,scaledSize:new s.maps.Size(32,32),anchor:new s.maps.Point(16,32)});const m=new s.maps.Marker({position:f.position,map:c,title:f.title,icon:h});m.addListener("click",()=>{var y;const k=new CustomEvent("marker-click",{detail:f});(y=r.value)==null||y.dispatchEvent(k)}),p.push(m)}))},b=()=>{p.forEach(s=>s.setMap(null)),p=[]},i=async()=>{var s,f,h;if(!(!t.origin||!t.destination||!c))try{d&&d.setMap(null);const m=new Headers;m.append("Content-Type","application/json"),m.append("X-Goog-Api-Key",n),m.append("X-Goog-FieldMask","routes.duration,routes.distanceMeters,routes.polyline.encodedPolyline");const k={origin:{location:{latLng:{latitude:t.origin.lat,longitude:t.origin.lng}}},destination:{location:{latLng:{latitude:t.destination.lat,longitude:t.destination.lng}}},travelMode:"DRIVE",routingPreference:"TRAFFIC_AWARE",computeAlternativeRoutes:!1,languageCode:"en-US",units:"METRIC"},y=await fetch("https://routes.googleapis.com/directions/v2:computeRoutes",{method:"POST",headers:m,body:JSON.stringify(k)});if(y.ok){const C=await y.json();if(C.routes&&C.routes.length>0){const I=C.routes[0];if((s=I.polyline)!=null&&s.encodedPolyline&&((f=google.maps.geometry)!=null&&f.encoding)){const N=google.maps.geometry.encoding.decodePath(I.polyline.encodedPolyline);d&&d.setMap(null),d=new google.maps.Polyline({path:N,geodesic:!0,strokeColor:"#5D87EE",strokeOpacity:.8,strokeWeight:5,map:c});const j=new google.maps.LatLngBounds;N.forEach(V=>j.extend(V)),c.fitBounds(j)}const L=I.distanceMeters||0,_=parseInt(((h=I.duration)==null?void 0:h.replace("s",""))||"0");a("route-calculated",{distance:L,duration:_,distanceText:`${(L/1e3).toFixed(1)} km`,durationText:_>3600?`${Math.floor(_/3600)}h ${Math.round(_%3600/60)}m`:`${Math.round(_/60)}m`})}}else{const C=await y.json();console.error("Routes API error:",C),u()}}catch(m){console.error("Error with Routes API:",m),u()}},u=()=>{if(!(!t.origin||!t.destination||!c)&&window.google&&window.google.maps&&window.google.maps.geometry){const s=new google.maps.LatLng(t.origin.lat,t.origin.lng),f=new google.maps.LatLng(t.destination.lat,t.destination.lng),h=google.maps.geometry.spherical.computeDistanceBetween(s,f),m=h/1e3/50*60*60;d&&d.setMap(null),d=new google.maps.Polyline({path:[t.origin,t.destination],geodesic:!0,strokeColor:"#5D87EE",strokeOpacity:.6,strokeWeight:4,map:c}),a("route-calculated",{distance:h,duration:m,distanceText:`${(h/1e3).toFixed(1)} km (approx)`,durationText:`~${Math.round(m/60)} min`,isEstimate:!0})}};return K(()=>{c&&(c.setCenter(t.center),c.setZoom(t.zoom),t.showRoute&&t.origin&&t.destination&&i())}),B(()=>{var s;g(),(s=r.value)==null||s.addEventListener("marker-click",f=>{const h=f.detail,m=new CustomEvent("marker-click",{detail:h});document.dispatchEvent(m)})}),Z(()=>{var s;b(),d&&(d.setMap(null),d=null),(s=r.value)==null||s.removeEventListener("marker-click",()=>{}),document.removeEventListener("marker-click",()=>{})}),e({mapContainer:r}),(s,f)=>(P(),R("div",{class:"google-map-container",ref_key:"mapContainer",ref:r},null,512))}}),ge=T(oe,[["__scopeId","data-v-fbdea156"]]),ne={class:"marker-container"},ie={key:0,class:"marker-label"},re=A({__name:"MapMarker",props:{label:{type:String,default:""},color:{type:String,default:"#5D87EE"}},setup(l){return z(e=>({"16b99aed":l.color})),(e,o)=>(P(),R("div",ne,[q(e.$slots,"icon",{},()=>[o[0]||(o[0]=w("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[w("path",{d:"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z",fill:"currentColor"})],-1))],!0),l.label?(P(),R("div",ie,J(l.label),1)):G("",!0)]))}}),me=T(re,[["__scopeId","data-v-6d1feb55"]]),se={class:"change-movers-form"},ae={class:"form-group"},le={class:"number-input-container"},ce=["disabled"],ue={key:0,class:"validation-error"},de={class:"action-buttons"},pe=A({__name:"ChangeMoversModal",props:{show:{type:Boolean,default:!1},initialCount:{type:Number,default:2}},emits:["update:show","confirm","cancel"],setup(l,{emit:e}){const o=l,t=e,a=S(o.show),n=S(o.initialCount.toString()),r=S(!0),c=S(!1);B(()=>{console.log("ChangeMoversModal mounted with props:",{show:o.show,initialCount:o.initialCount}),p()}),O(()=>o.show,i=>{console.log("show prop changed:",i),a.value=i,i&&(n.value=o.initialCount.toString(),c.value=!1,p(),console.log("Modal opened with initial count:",o.initialCount))}),O(a,i=>{console.log("isModalOpen changed:",i),t("update:show",i)}),O(()=>o.initialCount,i=>{console.log("initialCount prop changed:",i),n.value=i.toString(),p()}),O(n,()=>{p()});const p=()=>{c.value=!0;const i=n.value.trim();if(!i||isNaN(Number(i))){r.value=!1,console.log("Invalid input - not a number:",i);return}const u=parseInt(i);r.value=Number.isInteger(u)&&u>0,console.log("Validated input:",{value:i,parsed:u,isValid:r.value})},d=()=>{const i=parseInt(n.value)||0;n.value=(i+1).toString(),p()},g=()=>{const i=parseInt(n.value)||0;i>1&&(n.value=(i-1).toString(),p())},v=()=>{console.log("Cancel clicked"),a.value=!1,t("cancel")},b=()=>{if(p(),r.value){const i=parseInt(n.value);console.log("Confirm clicked with value:",i),t("confirm",i),a.value=!1}};return(i,u)=>(P(),W(X,{show:a.value,"onUpdate:show":u[1]||(u[1]=s=>a.value=s),title:"Change number of movers"},{default:x(()=>[w("div",se,[w("div",ae,[u[3]||(u[3]=w("label",null,"New number",-1)),w("div",le,[w("button",{type:"button",class:"number-btn decrement",onClick:g,disabled:parseInt(n.value)<=1||!r.value}," - ",8,ce),$(H,{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=s=>n.value=s),type:"number",min:"1",inputmode:"numeric",pattern:"[0-9]*",onInput:p,onChange:p,class:"number-input"},null,8,["modelValue"]),w("button",{type:"button",class:"number-btn increment",onClick:d}," + "),u[2]||(u[2]=w("span",{class:"input-label"},"movers",-1))]),!r.value&&c.value?(P(),R("div",ue," Please enter a valid number (minimum 1) ")):G("",!0)]),w("div",de,[$(F,{type:"secondary","small-button":"true",onClick:v},{default:x(()=>u[4]||(u[4]=[D("Close")])),_:1}),$(F,{"small-button":"true",onClick:b,disabled:!r.value},{default:x(()=>u[5]||(u[5]=[D("Confirm")])),_:1},8,["disabled"])])])]),_:1},8,["show"]))}}),ve=T(pe,[["__scopeId","data-v-27adb880"]]);export{ve as C,ge as G,me as M};
