import{d as N,r as _,ad as V,a0 as F,ae as z,a as R,o as S,_ as $,aA as K,aa as Z,e as b,t as q,f as G,ab as P,a8 as J,h as x,ac as W,b as A,i as L,G as j}from"./index-qO4Tp2FO.js";import{T as X}from"./Button.vue_vue_type_style_index_0_scoped_39e4a762_lang-BJAZL9qI.js";function H(l,e,o,t){function a(n){return n instanceof o?n:new o(function(r){r(n)})}return new(o||(o=Promise))(function(n,r){function c(g){try{p(t.next(g))}catch(m){r(m)}}function h(g){try{p(t.throw(g))}catch(m){r(m)}}function p(g){g.done?n(g.value):a(g.value).then(c,h)}p((t=t.apply(l,[])).next())})}function Q(l){return l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var Y=function l(e,o){if(e===o)return!0;if(e&&o&&typeof e=="object"&&typeof o=="object"){if(e.constructor!==o.constructor)return!1;var t,a,n;if(Array.isArray(e)){if(t=e.length,t!=o.length)return!1;for(a=t;a--!==0;)if(!l(e[a],o[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===o.source&&e.flags===o.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===o.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===o.toString();if(n=Object.keys(e),t=n.length,t!==Object.keys(o).length)return!1;for(a=t;a--!==0;)if(!Object.prototype.hasOwnProperty.call(o,n[a]))return!1;for(a=t;a--!==0;){var r=n[a];if(!l(e[r],o[r]))return!1}return!0}return e!==e&&o!==o},ee=Q(Y);const B="__googleMapsScriptId";var I;(function(l){l[l.INITIALIZED=0]="INITIALIZED",l[l.LOADING=1]="LOADING",l[l.SUCCESS=2]="SUCCESS",l[l.FAILURE=3]="FAILURE"})(I||(I={}));class E{constructor({apiKey:e,authReferrerPolicy:o,channel:t,client:a,id:n=B,language:r,libraries:c=[],mapIds:h,nonce:p,region:g,retries:m=3,url:C="https://maps.googleapis.com/maps/api/js",version:i}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=o,this.channel=t,this.client=a,this.id=n||B,this.language=r,this.libraries=c,this.mapIds=h,this.nonce=p,this.region=g,this.retries=m,this.url=C,this.version=i,E.instance){if(!ee(this.options,E.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(E.instance.options)}`);return E.instance}E.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?I.FAILURE:this.done?I.SUCCESS:this.loading?I.LOADING:I.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,o)=>{this.loadCallback(t=>{t?o(t.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,o;if(document.getElementById(this.id)){this.callback();return}const t={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(t).forEach(n=>!t[n]&&delete t[n]),!((o=(e=window==null?void 0:window.google)===null||e===void 0?void 0:e.maps)===null||o===void 0)&&o.importLibrary||(n=>{let r,c,h,p="The Google Maps JavaScript API",g="google",m="importLibrary",C="__ib__",i=document,u=window;u=u[g]||(u[g]={});const s=u.maps||(u.maps={}),f=new Set,d=new URLSearchParams,y=()=>r||(r=new Promise((w,v)=>H(this,void 0,void 0,function*(){var k;yield c=i.createElement("script"),c.id=this.id,d.set("libraries",[...f]+"");for(h in n)d.set(h.replace(/[A-Z]/g,O=>"_"+O[0].toLowerCase()),n[h]);d.set("callback",g+".maps."+C),c.src=this.url+"?"+d,s[C]=w,c.onerror=()=>r=v(Error(p+" could not load.")),c.nonce=this.nonce||((k=i.querySelector("script[nonce]"))===null||k===void 0?void 0:k.nonce)||"",i.head.append(c)})));s[m]?console.warn(p+" only loads once. Ignoring:",n):s[m]=(w,...v)=>f.add(w)&&y().then(()=>s[m](w,...v))})(t);const a=this.libraries.map(n=>this.importLibrary(n));a.length||a.push(this.importLibrary("core")),Promise.all(a).then(()=>this.callback(),n=>{const r=new ErrorEvent("error",{error:n});this.loadErrorCallback(r)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const o=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${o} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},o)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}const te=N({__name:"GoogleMap",props:{height:{type:[String,Number],default:"300px"},center:{type:Object,default:()=>({lat:40.7128,lng:-74.006})},zoom:{type:Number,default:12},markers:{type:Array,default:()=>[]},showRoute:{type:Boolean,default:!1},origin:{type:Object,default:null},destination:{type:Object,default:null}},emits:["route-calculated"],setup(l,{expose:e,emit:o}){const t=l,a=o,n="AIzaSyCeCJv_Q1i0B4ClZouNC1hND4lIM_D_EOo",r=_(null);let c=null,h=[],p=null;const g=async()=>{if(r.value)try{const f=await new E({apiKey:n,version:"weekly",libraries:["places","geometry","drawing","routes"]}).load();c=new f.maps.Map(r.value,{center:t.center,zoom:t.zoom,disableDefaultUI:!0,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]}),t.showRoute&&t.origin&&t.destination&&i(),m(f)}catch(s){console.error("Error loading Google Maps:",s)}},m=s=>{c&&(C(),t.markers.forEach(f=>{let d=f.icon;d&&d.url&&(d={...d,scaledSize:new s.maps.Size(32,32),anchor:new s.maps.Point(16,32)});const y=new s.maps.Marker({position:f.position,map:c,title:f.title,icon:d});y.addListener("click",()=>{var v;const w=new CustomEvent("marker-click",{detail:f});(v=r.value)==null||v.dispatchEvent(w)}),h.push(y)}))},C=()=>{h.forEach(s=>s.setMap(null)),h=[]},i=async()=>{var s,f;if(!(!t.origin||!t.destination||!c))try{p&&p.setMap(null);const d=new Headers;d.append("Content-Type","application/json"),d.append("X-Goog-Api-Key",n),d.append("X-Goog-FieldMask","routes.duration,routes.distanceMeters,routes.polyline.encodedPolyline");const y={origin:{location:{latLng:{latitude:t.origin.lat,longitude:t.origin.lng}}},destination:{location:{latLng:{latitude:t.destination.lat,longitude:t.destination.lng}}},travelMode:"DRIVE",routingPreference:"TRAFFIC_AWARE",computeAlternativeRoutes:!1,languageCode:"en-US",units:"METRIC"},w=await fetch("https://routes.googleapis.com/directions/v2:computeRoutes",{method:"POST",headers:d,body:JSON.stringify(y)});if(w.ok){const v=await w.json();if(v.routes&&v.routes.length>0){const k=v.routes[0];if((s=k.polyline)!=null&&s.encodedPolyline){const T=google.maps.geometry.encoding.decodePath(k.polyline.encodedPolyline);p&&p.setMap(null),p=new google.maps.Polyline({path:T,geodesic:!0,strokeColor:"#5D87EE",strokeOpacity:.8,strokeWeight:5,map:c});const D=new google.maps.LatLngBounds;T.forEach(U=>D.extend(U)),c.fitBounds(D)}const O=k.distanceMeters||0,M=parseInt(((f=k.duration)==null?void 0:f.replace("s",""))||"0");a("route-calculated",{distance:O,duration:M,distanceText:`${(O/1e3).toFixed(1)} km`,durationText:M>3600?`${Math.floor(M/3600)}h ${Math.round(M%3600/60)}m`:`${Math.round(M/60)}m`})}}else{const v=await w.json();console.error("Routes API error:",v),u()}}catch(d){console.error("Error with Routes API:",d),u()}},u=()=>{if(!(!t.origin||!t.destination||!c)&&window.google&&window.google.maps&&window.google.maps.geometry){const s=new google.maps.LatLng(t.origin.lat,t.origin.lng),f=new google.maps.LatLng(t.destination.lat,t.destination.lng),d=google.maps.geometry.spherical.computeDistanceBetween(s,f),y=d/1e3/50*60*60;p&&p.setMap(null),p=new google.maps.Polyline({path:[t.origin,t.destination],geodesic:!0,strokeColor:"#5D87EE",strokeOpacity:.6,strokeWeight:4,map:c}),a("route-calculated",{distance:d,duration:y,distanceText:`${(d/1e3).toFixed(1)} km (approx)`,durationText:`~${Math.round(y/60)} min`,isEstimate:!0})}};return V(()=>{c&&(c.setCenter(t.center),c.setZoom(t.zoom),t.showRoute&&t.origin&&t.destination&&i())}),F(()=>{var s;g(),(s=r.value)==null||s.addEventListener("marker-click",f=>{const d=f.detail,y=new CustomEvent("marker-click",{detail:d});document.dispatchEvent(y)})}),z(()=>{var s;C(),p&&(p.setMap(null),p=null),(s=r.value)==null||s.removeEventListener("marker-click",()=>{}),document.removeEventListener("marker-click",()=>{})}),e({mapContainer:r}),(s,f)=>(S(),R("div",{class:"google-map-container",ref_key:"mapContainer",ref:r},null,512))}}),fe=$(te,[["__scopeId","data-v-5e6cce1a"]]),oe={class:"marker-container"},ne={key:0,class:"marker-label"},ie=N({__name:"MapMarker",props:{label:{type:String,default:""},color:{type:String,default:"#5D87EE"}},setup(l){return K(e=>({"16b99aed":l.color})),(e,o)=>(S(),R("div",oe,[Z(e.$slots,"icon",{},()=>[o[0]||(o[0]=b("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[b("path",{d:"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z",fill:"currentColor"})],-1))],!0),l.label?(S(),R("div",ne,q(l.label),1)):G("",!0)]))}}),ge=$(ie,[["__scopeId","data-v-6d1feb55"]]),re={class:"change-movers-form"},se={class:"form-group"},ae={class:"number-input-container"},le=["disabled"],ce={key:0,class:"validation-error"},ue={class:"action-buttons"},de=N({__name:"ChangeMoversModal",props:{show:{type:Boolean,default:!1},initialCount:{type:Number,default:2}},emits:["update:show","confirm","cancel"],setup(l,{emit:e}){const o=l,t=e,a=_(o.show),n=_(o.initialCount.toString()),r=_(!0),c=_(!1);F(()=>{console.log("ChangeMoversModal mounted with props:",{show:o.show,initialCount:o.initialCount}),h()}),P(()=>o.show,i=>{console.log("show prop changed:",i),a.value=i,i&&(n.value=o.initialCount.toString(),c.value=!1,h(),console.log("Modal opened with initial count:",o.initialCount))}),P(a,i=>{console.log("isModalOpen changed:",i),t("update:show",i)}),P(()=>o.initialCount,i=>{console.log("initialCount prop changed:",i),n.value=i.toString(),h()}),P(n,()=>{h()});const h=()=>{c.value=!0;const i=n.value.trim();if(!i||isNaN(Number(i))){r.value=!1,console.log("Invalid input - not a number:",i);return}const u=parseInt(i);r.value=Number.isInteger(u)&&u>0,console.log("Validated input:",{value:i,parsed:u,isValid:r.value})},p=()=>{const i=parseInt(n.value)||0;n.value=(i+1).toString(),h()},g=()=>{const i=parseInt(n.value)||0;i>1&&(n.value=(i-1).toString(),h())},m=()=>{console.log("Cancel clicked"),a.value=!1,t("cancel")},C=()=>{if(h(),r.value){const i=parseInt(n.value);console.log("Confirm clicked with value:",i),t("confirm",i),a.value=!1}};return(i,u)=>(S(),J(W,{show:a.value,"onUpdate:show":u[1]||(u[1]=s=>a.value=s),title:"Change number of movers"},{default:x(()=>[b("div",re,[b("div",se,[u[3]||(u[3]=b("label",null,"New number",-1)),b("div",ae,[b("button",{type:"button",class:"number-btn decrement",onClick:g,disabled:parseInt(n.value)<=1||!r.value}," - ",8,le),A(X,{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=s=>n.value=s),type:"number",min:"1",inputmode:"numeric",pattern:"[0-9]*",onInput:h,onChange:h,class:"number-input"},null,8,["modelValue"]),b("button",{type:"button",class:"number-btn increment",onClick:p}," + "),u[2]||(u[2]=b("span",{class:"input-label"},"movers",-1))]),!r.value&&c.value?(S(),R("div",ce," Please enter a valid number (minimum 1) ")):G("",!0)]),b("div",ue,[A(j,{type:"secondary","small-button":"true",onClick:m},{default:x(()=>u[4]||(u[4]=[L("Close")])),_:1}),A(j,{"small-button":"true",onClick:C,disabled:!r.value},{default:x(()=>u[5]||(u[5]=[L("Confirm")])),_:1},8,["disabled"])])])]),_:1},8,["show"]))}}),me=$(de,[["__scopeId","data-v-27adb880"]]);export{me as C,fe as G,ge as M};
