import{k as Q,l as X,m as x,n as R,p as S,q as h,s as B,x as Y,y as Z,z as V,d as j,A as ee,B as oe,c as W,C as re,r as z,D as u,N as se,E as te,I as m,J as ne,K as le,L as ae,M as ie,O as ce,W as de,P as ue,S as ge,Q as fe,R as ve,u as pe,T as he,U as be,a as A,b as C,e as H,V as k,h as P,G as E,j as me,o as T,H as Ce,X as ye,i as $,Y as _e,t as Ie,Z as xe,f as Re,$ as qe,F as ze,_ as Se}from"./index-cq1LsArC.js";function ke(i){const{lineHeight:o,borderRadius:t,fontWeightStrong:y,baseColor:l,dividerColor:g,actionColor:p,textColor1:f,textColor2:n,closeColorHover:v,closeColorPressed:d,closeIconColor:_,closeIconColorHover:I,closeIconColorPressed:a,infoColor:s,successColor:q,warningColor:r,errorColor:e,fontSize:c}=i;return Object.assign(Object.assign({},X),{fontSize:c,lineHeight:o,titleFontWeight:y,borderRadius:t,border:`1px solid ${g}`,color:p,titleTextColor:f,iconColor:n,contentTextColor:n,closeBorderRadius:t,closeColorHover:v,closeColorPressed:d,closeIconColor:_,closeIconColorHover:I,closeIconColorPressed:a,borderInfo:`1px solid ${x(l,R(s,{alpha:.25}))}`,colorInfo:x(l,R(s,{alpha:.08})),titleTextColorInfo:f,iconColorInfo:s,contentTextColorInfo:n,closeColorHoverInfo:v,closeColorPressedInfo:d,closeIconColorInfo:_,closeIconColorHoverInfo:I,closeIconColorPressedInfo:a,borderSuccess:`1px solid ${x(l,R(q,{alpha:.25}))}`,colorSuccess:x(l,R(q,{alpha:.08})),titleTextColorSuccess:f,iconColorSuccess:q,contentTextColorSuccess:n,closeColorHoverSuccess:v,closeColorPressedSuccess:d,closeIconColorSuccess:_,closeIconColorHoverSuccess:I,closeIconColorPressedSuccess:a,borderWarning:`1px solid ${x(l,R(r,{alpha:.33}))}`,colorWarning:x(l,R(r,{alpha:.08})),titleTextColorWarning:f,iconColorWarning:r,contentTextColorWarning:n,closeColorHoverWarning:v,closeColorPressedWarning:d,closeIconColorWarning:_,closeIconColorHoverWarning:I,closeIconColorPressedWarning:a,borderError:`1px solid ${x(l,R(e,{alpha:.25}))}`,colorError:x(l,R(e,{alpha:.08})),titleTextColorError:f,iconColorError:e,contentTextColorError:n,closeColorHoverError:v,closeColorPressedError:d,closeIconColorError:_,closeIconColorHoverError:I,closeIconColorPressedError:a})}const Pe={name:"Alert",common:Q,self:ke},Te=S("alert",`
 line-height: var(--n-line-height);
 border-radius: var(--n-border-radius);
 position: relative;
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-color);
 text-align: start;
 word-break: break-word;
`,[h("border",`
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 transition: border-color .3s var(--n-bezier);
 border: var(--n-border);
 pointer-events: none;
 `),B("closable",[S("alert-body",[h("title",`
 padding-right: 24px;
 `)])]),h("icon",{color:"var(--n-icon-color)"}),S("alert-body",{padding:"var(--n-padding)"},[h("title",{color:"var(--n-title-text-color)"}),h("content",{color:"var(--n-content-text-color)"})]),Y({originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.9)"}}),h("icon",`
 position: absolute;
 left: 0;
 top: 0;
 align-items: center;
 justify-content: center;
 display: flex;
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 font-size: var(--n-icon-size);
 margin: var(--n-icon-margin);
 `),h("close",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 position: absolute;
 right: 0;
 top: 0;
 margin: var(--n-close-margin);
 `),B("show-icon",[S("alert-body",{paddingLeft:"calc(var(--n-icon-margin-left) + var(--n-icon-size) + var(--n-icon-margin-right))"})]),B("right-adjust",[S("alert-body",{paddingRight:"calc(var(--n-close-size) + var(--n-padding) + 2px)"})]),S("alert-body",`
 border-radius: var(--n-border-radius);
 transition: border-color .3s var(--n-bezier);
 `,[h("title",`
 transition: color .3s var(--n-bezier);
 font-size: 16px;
 line-height: 19px;
 font-weight: var(--n-title-font-weight);
 `,[Z("& +",[h("content",{marginTop:"9px"})])]),h("content",{transition:"color .3s var(--n-bezier)",fontSize:"var(--n-font-size)"})]),h("icon",{transition:"color .3s var(--n-bezier)"})]),Ae=Object.assign(Object.assign({},V.props),{title:String,showIcon:{type:Boolean,default:!0},type:{type:String,default:"default"},bordered:{type:Boolean,default:!0},closable:Boolean,onClose:Function,onAfterLeave:Function,onAfterHide:Function}),Ee=j({name:"Alert",inheritAttrs:!1,props:Ae,slots:Object,setup(i){const{mergedClsPrefixRef:o,mergedBorderedRef:t,inlineThemeDisabled:y,mergedRtlRef:l}=ee(i),g=V("Alert","-alert",Te,Pe,i,o),p=oe("Alert",l,o),f=W(()=>{const{common:{cubicBezierEaseInOut:a},self:s}=g.value,{fontSize:q,borderRadius:r,titleFontWeight:e,lineHeight:c,iconSize:w,iconMargin:F,iconMarginRtl:L,closeIconSize:N,closeBorderRadius:D,closeSize:M,closeMargin:O,closeMarginRtl:G,padding:K}=s,{type:b}=i,{left:U,right:J}=te(F);return{"--n-bezier":a,"--n-color":s[m("color",b)],"--n-close-icon-size":N,"--n-close-border-radius":D,"--n-close-color-hover":s[m("closeColorHover",b)],"--n-close-color-pressed":s[m("closeColorPressed",b)],"--n-close-icon-color":s[m("closeIconColor",b)],"--n-close-icon-color-hover":s[m("closeIconColorHover",b)],"--n-close-icon-color-pressed":s[m("closeIconColorPressed",b)],"--n-icon-color":s[m("iconColor",b)],"--n-border":s[m("border",b)],"--n-title-text-color":s[m("titleTextColor",b)],"--n-content-text-color":s[m("contentTextColor",b)],"--n-line-height":c,"--n-border-radius":r,"--n-font-size":q,"--n-title-font-weight":e,"--n-icon-size":w,"--n-icon-margin":F,"--n-icon-margin-rtl":L,"--n-close-size":M,"--n-close-margin":O,"--n-close-margin-rtl":G,"--n-padding":K,"--n-icon-margin-left":U,"--n-icon-margin-right":J}}),n=y?re("alert",W(()=>i.type[0]),f,i):void 0,v=z(!0),d=()=>{const{onAfterLeave:a,onAfterHide:s}=i;a&&a(),s&&s()};return{rtlEnabled:p,mergedClsPrefix:o,mergedBordered:t,visible:v,handleCloseClick:()=>{var a;Promise.resolve((a=i.onClose)===null||a===void 0?void 0:a.call(i)).then(s=>{s!==!1&&(v.value=!1)})},handleAfterLeave:()=>{d()},mergedTheme:g,cssVars:y?void 0:f,themeClass:n==null?void 0:n.themeClass,onRender:n==null?void 0:n.onRender}},render(){var i;return(i=this.onRender)===null||i===void 0||i.call(this),u(se,{onAfterLeave:this.handleAfterLeave},{default:()=>{const{mergedClsPrefix:o,$slots:t}=this,y={class:[`${o}-alert`,this.themeClass,this.closable&&`${o}-alert--closable`,this.showIcon&&`${o}-alert--show-icon`,!this.title&&this.closable&&`${o}-alert--right-adjust`,this.rtlEnabled&&`${o}-alert--rtl`],style:this.cssVars,role:"alert"};return this.visible?u("div",Object.assign({},ne(this.$attrs,y)),this.closable&&u(le,{clsPrefix:o,class:`${o}-alert__close`,onClick:this.handleCloseClick}),this.bordered&&u("div",{class:`${o}-alert__border`}),this.showIcon&&u("div",{class:`${o}-alert__icon`,"aria-hidden":"true"},ae(t.icon,()=>[u(ie,{clsPrefix:o},{default:()=>{switch(this.type){case"success":return u(ge,null);case"info":return u(ue,null);case"warning":return u(de,null);case"error":return u(ce,null);default:return null}}})])),u("div",{class:[`${o}-alert-body`,this.mergedBordered&&`${o}-alert-body--bordered`]},fe(t.header,l=>{const g=l||this.title;return g?u("div",{class:`${o}-alert-body__title`},g):null}),t.default&&u("div",{class:`${o}-alert-body__content`},t))):null}})}}),$e={class:"details-page"},we={class:"details-content"},Be={key:0,class:"loading-container"},He={key:1,class:"error-container"},Fe={key:2,class:"form-container"},We={class:"action-buttons"},Ve=j({__name:"DetailsView",setup(i){const o=me(),t=ve(),y=pe(),l=he(),g=z(!1),p=z(!1),f=z(!1),n=z(""),v=z(),d=z({property_type:"residential",square_feet:1e3,additional_objects:[],movers_count:2,hourly_rate:100,departure_time:"",bedrooms:2,addresses:[{address:"",type:"loading",order:0,latitude:0,longitude:0},{address:"",type:"unloading",order:1,latitude:0,longitude:0}],materials:[],packing_options:[]});be(async()=>{if(!y.isAuthenticated){o.push("/requests");return}g.value=!0,n.value="";try{const r=Number(o.currentRoute.value.query.id);if(r){if((!t.selectedRequest||t.selectedRequest.id!==r)&&(!await t.getRequestById(r)||!t.selectedRequest)){n.value=`Failed to load request #${r}`,g.value=!1;return}f.value=!0;const e=t.selectedRequest;console.log("Loading request data:",e),console.log("Original addresses from API:",e.addresses),d.value={property_type:e.property_type||"residential",square_feet:e.square_feet||1e3,additional_objects:e.additional_objects||[],movers_count:e.movers_count||2,hourly_rate:e.hourly_rate||100,departure_time:e.departure_time||"",bedrooms:e.bedrooms||2,packing_options:e.packing_options||[],addresses:e.addresses&&e.addresses.length>0?e.addresses.map(c=>(console.log("Processing address:",c),console.log("location_type value:",c.location_type,"type:",typeof c.location_type),{...c,location_type:c.location_type})):[{address:"",type:"loading",location_type:null,order:0,latitude:0,longitude:0},{address:"",type:"unloading",location_type:null,order:1,latitude:0,longitude:0}],materials:e.materials||[]},console.log("Form data after initialization:",d.value),console.log("Processed addresses:",d.value.addresses)}}catch(r){console.error("Error loading request:",r),n.value="Failed to load request details"}finally{g.value=!1}});const _=r=>(console.log("Preparing data for API:",r),console.log("Addresses with location_type:",r.addresses.map(e=>({address:e.address,type:e.type,location_type:e.location_type}))),r),I=async()=>{var r;if(a()){p.value=!0;try{if(f.value&&((r=t.selectedRequest)!=null&&r.id)){const e=_(d.value);await t.updateRequest(t.selectedRequest.id,e)?(l.success("Request updated successfully!"),o.push("/requests")):l.error("Failed to update request")}}catch(e){l.error("An error occurred while saving"),console.error("Save error:",e)}finally{p.value=!1}}},a=()=>{if(!v.value)return!1;const r=v.value.validate();return r.valid?!0:(l.error(r.message),!1)},s=()=>{var r;(r=t.selectedRequest)!=null&&r.id&&o.push({path:"/tracking",query:{id:t.selectedRequest.id}})},q=()=>{o.push("/requests")};return(r,e)=>(T(),A("div",$e,[C(Ce,{title:"Request Details"}),H("main",we,[g.value?(T(),A("div",Be,[C(k(ye),{size:"medium"}),e[2]||(e[2]=H("p",null,"Loading request details...",-1))])):n.value?(T(),A("div",He,[C(k(Ee),{type:"error",title:n.value},null,8,["title"]),C(E,{onClick:e[0]||(e[0]=c=>k(o).push("/requests")),class:"mt-4"},{default:P(()=>e[3]||(e[3]=[$(" Back to Requests ")])),_:1})])):(T(),A("div",Fe,[C(k(qe),null,{default:P(()=>{var c;return[C(_e,{ref_key:"requestFormRef",ref:v,modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=w=>d.value=w),mode:"edit",loading:p.value},null,8,["modelValue","loading"]),H("div",We,[C(E,{onClick:q,disabled:p.value},{default:P(()=>e[4]||(e[4]=[$(" Cancel ")])),_:1},8,["disabled"]),C(E,{onClick:I,disabled:p.value},{default:P(()=>[$(Ie(p.value?"Saving...":"Save Changes"),1)]),_:1},8,["disabled"]),f.value&&((c=k(t).selectedRequest)!=null&&c.id)?(T(),xe(E,{key:0,onClick:s,disabled:p.value},{default:P(()=>e[5]||(e[5]=[$(" Track Request ")])),_:1},8,["disabled"])):Re("",!0)])]}),_:1})]))]),C(ze)]))}}),Le=Se(Ve,[["__scopeId","data-v-5a2e8eeb"]]);export{Le as default};
