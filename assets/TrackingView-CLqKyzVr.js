import{p as Oe,q as De,d as V,r as p,s as ze,c as N,x as Be,y as Le,z as Ie,A as H,B as Ae,C as se,g as pe,D as xe,E as x,T as Fe,G as He,I as w,J as re,K as O,L as j,M as Z,N as Te,O as Pe,P as Re,Q as Ve,R as G,S as We,U as je,o as k,a as U,V as Ue,e as r,t as A,f as ae,_ as K,W as Xe,l as ge,X as Q,h as B,b as S,i as P,k as Ye,u as Ze,Y as Ge,m as oe,j as Ke,H as Qe,Z as ke,$ as Se,F as Je}from"./index-BGsP3Z34.js";import{G as et,M as tt}from"./MapInfoWindow-BZ5XVJ1a.js";import{G as ne}from"./GradientButton-DTIXridY.js";import{s as ot,d as be,c as nt,u as st,a as at,p as rt,m as lt,F as it,S as Ne,f as dt,b as Me,e as ut,L as ct,g as ft,z as mt,N as vt,M as we,T as Ee,B as ye}from"./Button-rbXIlr8G.js";const ht=/^(\d|\.)+$/,qe=/(\d|\.)+/;function _e(t,{c:o=1,offset:e=0,attachPx:m=!0}={}){if(typeof t=="number"){const s=(t+e)*o;return s===0?"0":`${s}px`}else if(typeof t=="string")if(ht.test(t)){const s=(Number(t)+e)*o;return m?s===0?"0":`${s}px`:`${s}`}else{const s=qe.exec(t);return s?t.replace(qe,String((Number(s[0])+e)*o)):t}return t}function pt(t){const{modalColor:o,textColor1:e,textColor2:m,boxShadow3:s,lineHeight:d,fontWeightStrong:l,dividerColor:h,closeColorHover:c,closeColorPressed:g,closeIconColor:$,closeIconColorHover:C,closeIconColorPressed:_,borderRadius:u,primaryColorHover:v}=t;return{bodyPadding:"16px 24px",borderRadius:u,headerPadding:"16px 24px",footerPadding:"16px 24px",color:o,textColor:m,titleTextColor:e,titleFontSize:"18px",titleFontWeight:l,boxShadow:s,lineHeight:d,headerBorderBottom:`1px solid ${h}`,footerBorderTop:`1px solid ${h}`,closeIconColor:$,closeIconColorHover:C,closeIconColorPressed:_,closeSize:"22px",closeIconSize:"18px",closeColorHover:c,closeColorPressed:g,closeBorderRadius:u,resizableTriggerColorHover:v}}const gt=Oe({name:"Drawer",common:De,peers:{Scrollbar:ot},self:pt}),bt=V({name:"NDrawerContent",inheritAttrs:!1,props:{blockScroll:Boolean,show:{type:Boolean,default:void 0},displayDirective:{type:String,required:!0},placement:{type:String,required:!0},contentClass:String,contentStyle:[Object,String],nativeScrollbar:{type:Boolean,required:!0},scrollbarProps:Object,trapFocus:{type:Boolean,default:!0},autoFocus:{type:Boolean,default:!0},showMask:{type:[Boolean,String],required:!0},maxWidth:Number,maxHeight:Number,minWidth:Number,minHeight:Number,resizable:Boolean,onClickoutside:Function,onAfterLeave:Function,onAfterEnter:Function,onEsc:Function},setup(t){const o=p(!!t.show),e=p(null),m=ze(be);let s=0,d="",l=null;const h=p(!1),c=p(!1),g=N(()=>t.placement==="top"||t.placement==="bottom"),{mergedClsPrefixRef:$,mergedRtlRef:C}=Be(t),_=Le("Drawer",C,$),u=f,v=b=>{c.value=!0,s=g.value?b.clientY:b.clientX,d=document.body.style.cursor,document.body.style.cursor=g.value?"ns-resize":"ew-resize",document.body.addEventListener("mousemove",L),document.body.addEventListener("mouseleave",u),document.body.addEventListener("mouseup",f)},I=()=>{l!==null&&(window.clearTimeout(l),l=null),c.value?h.value=!0:l=window.setTimeout(()=>{h.value=!0},300)},J=()=>{l!==null&&(window.clearTimeout(l),l=null),h.value=!1},{doUpdateHeight:ee,doUpdateWidth:te}=m,X=b=>{const{maxWidth:q}=t;if(q&&b>q)return q;const{minWidth:F}=t;return F&&b<F?F:b},D=b=>{const{maxHeight:q}=t;if(q&&b>q)return q;const{minHeight:F}=t;return F&&b<F?F:b};function L(b){var q,F;if(c.value)if(g.value){let T=((q=e.value)===null||q===void 0?void 0:q.offsetHeight)||0;const W=s-b.clientY;T+=t.placement==="bottom"?W:-W,T=D(T),ee(T),s=b.clientY}else{let T=((F=e.value)===null||F===void 0?void 0:F.offsetWidth)||0;const W=s-b.clientX;T+=t.placement==="right"?W:-W,T=X(T),te(T),s=b.clientX}}function f(){c.value&&(s=0,c.value=!1,document.body.style.cursor=d,document.body.removeEventListener("mousemove",L),document.body.removeEventListener("mouseup",f),document.body.removeEventListener("mouseleave",u))}Ie(()=>{t.show&&(o.value=!0)}),H(()=>t.show,b=>{b||f()}),Ae(()=>{f()});const y=N(()=>{const{show:b}=t,q=[[xe,b]];return t.showMask||q.push([nt,t.onClickoutside,void 0,{capture:!0}]),q});function M(){var b;o.value=!1,(b=t.onAfterLeave)===null||b===void 0||b.call(t)}return st(N(()=>t.blockScroll&&o.value)),se(at,e),se(rt,null),se(lt,null),{bodyRef:e,rtlEnabled:_,mergedClsPrefix:m.mergedClsPrefixRef,isMounted:m.isMountedRef,mergedTheme:m.mergedThemeRef,displayed:o,transitionName:N(()=>({right:"slide-in-from-right-transition",left:"slide-in-from-left-transition",top:"slide-in-from-top-transition",bottom:"slide-in-from-bottom-transition"})[t.placement]),handleAfterLeave:M,bodyDirectives:y,handleMousedownResizeTrigger:v,handleMouseenterResizeTrigger:I,handleMouseleaveResizeTrigger:J,isDragging:c,isHoverOnResizeTrigger:h}},render(){const{$slots:t,mergedClsPrefix:o}=this;return this.displayDirective==="show"||this.displayed||this.show?pe(x("div",{role:"none"},x(it,{disabled:!this.showMask||!this.trapFocus,active:this.show,autoFocus:this.autoFocus,onEsc:this.onEsc},{default:()=>x(Fe,{name:this.transitionName,appear:this.isMounted,onAfterEnter:this.onAfterEnter,onAfterLeave:this.handleAfterLeave},{default:()=>pe(x("div",He(this.$attrs,{role:"dialog",ref:"bodyRef","aria-modal":"true",class:[`${o}-drawer`,this.rtlEnabled&&`${o}-drawer--rtl`,`${o}-drawer--${this.placement}-placement`,this.isDragging&&`${o}-drawer--unselectable`,this.nativeScrollbar&&`${o}-drawer--native-scrollbar`]}),[this.resizable?x("div",{class:[`${o}-drawer__resize-trigger`,(this.isDragging||this.isHoverOnResizeTrigger)&&`${o}-drawer__resize-trigger--hover`],onMouseenter:this.handleMouseenterResizeTrigger,onMouseleave:this.handleMouseleaveResizeTrigger,onMousedown:this.handleMousedownResizeTrigger}):null,this.nativeScrollbar?x("div",{class:[`${o}-drawer-content-wrapper`,this.contentClass],style:this.contentStyle,role:"none"},t):x(Ne,Object.assign({},this.scrollbarProps,{contentStyle:this.contentStyle,contentClass:[`${o}-drawer-content-wrapper`,this.contentClass],theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar}),t)]),this.bodyDirectives)})})),[[xe,this.displayDirective==="if"||this.displayed||this.show]]):null}}),{cubicBezierEaseIn:wt,cubicBezierEaseOut:yt}=re;function Ct({duration:t="0.3s",leaveDuration:o="0.2s",name:e="slide-in-from-bottom"}={}){return[w(`&.${e}-transition-leave-active`,{transition:`transform ${o} ${wt}`}),w(`&.${e}-transition-enter-active`,{transition:`transform ${t} ${yt}`}),w(`&.${e}-transition-enter-to`,{transform:"translateY(0)"}),w(`&.${e}-transition-enter-from`,{transform:"translateY(100%)"}),w(`&.${e}-transition-leave-from`,{transform:"translateY(0)"}),w(`&.${e}-transition-leave-to`,{transform:"translateY(100%)"})]}const{cubicBezierEaseIn:$t,cubicBezierEaseOut:xt}=re;function Rt({duration:t="0.3s",leaveDuration:o="0.2s",name:e="slide-in-from-left"}={}){return[w(`&.${e}-transition-leave-active`,{transition:`transform ${o} ${$t}`}),w(`&.${e}-transition-enter-active`,{transition:`transform ${t} ${xt}`}),w(`&.${e}-transition-enter-to`,{transform:"translateX(0)"}),w(`&.${e}-transition-enter-from`,{transform:"translateX(-100%)"}),w(`&.${e}-transition-leave-from`,{transform:"translateX(0)"}),w(`&.${e}-transition-leave-to`,{transform:"translateX(-100%)"})]}const{cubicBezierEaseIn:kt,cubicBezierEaseOut:St}=re;function Mt({duration:t="0.3s",leaveDuration:o="0.2s",name:e="slide-in-from-right"}={}){return[w(`&.${e}-transition-leave-active`,{transition:`transform ${o} ${kt}`}),w(`&.${e}-transition-enter-active`,{transition:`transform ${t} ${St}`}),w(`&.${e}-transition-enter-to`,{transform:"translateX(0)"}),w(`&.${e}-transition-enter-from`,{transform:"translateX(100%)"}),w(`&.${e}-transition-leave-from`,{transform:"translateX(0)"}),w(`&.${e}-transition-leave-to`,{transform:"translateX(100%)"})]}const{cubicBezierEaseIn:qt,cubicBezierEaseOut:_t}=re;function zt({duration:t="0.3s",leaveDuration:o="0.2s",name:e="slide-in-from-top"}={}){return[w(`&.${e}-transition-leave-active`,{transition:`transform ${o} ${qt}`}),w(`&.${e}-transition-enter-active`,{transition:`transform ${t} ${_t}`}),w(`&.${e}-transition-enter-to`,{transform:"translateY(0)"}),w(`&.${e}-transition-enter-from`,{transform:"translateY(-100%)"}),w(`&.${e}-transition-leave-from`,{transform:"translateY(0)"}),w(`&.${e}-transition-leave-to`,{transform:"translateY(-100%)"})]}const Bt=w([O("drawer",`
 word-break: break-word;
 line-height: var(--n-line-height);
 position: absolute;
 pointer-events: all;
 box-shadow: var(--n-box-shadow);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 background-color: var(--n-color);
 color: var(--n-text-color);
 box-sizing: border-box;
 `,[Mt(),Rt(),zt(),Ct(),j("unselectable",`
 user-select: none; 
 -webkit-user-select: none;
 `),j("native-scrollbar",[O("drawer-content-wrapper",`
 overflow: auto;
 height: 100%;
 `)]),Z("resize-trigger",`
 position: absolute;
 background-color: #0000;
 transition: background-color .3s var(--n-bezier);
 `,[j("hover",`
 background-color: var(--n-resize-trigger-color-hover);
 `)]),O("drawer-content-wrapper",`
 box-sizing: border-box;
 `),O("drawer-content",`
 height: 100%;
 display: flex;
 flex-direction: column;
 `,[j("native-scrollbar",[O("drawer-body-content-wrapper",`
 height: 100%;
 overflow: auto;
 `)]),O("drawer-body",`
 flex: 1 0 0;
 overflow: hidden;
 `),O("drawer-body-content-wrapper",`
 box-sizing: border-box;
 padding: var(--n-body-padding);
 `),O("drawer-header",`
 font-weight: var(--n-title-font-weight);
 line-height: 1;
 font-size: var(--n-title-font-size);
 color: var(--n-title-text-color);
 padding: var(--n-header-padding);
 transition: border .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-divider-color);
 border-bottom: var(--n-header-border-bottom);
 display: flex;
 justify-content: space-between;
 align-items: center;
 `,[Z("main",`
 flex: 1;
 `),Z("close",`
 margin-left: 6px;
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `)]),O("drawer-footer",`
 display: flex;
 justify-content: flex-end;
 border-top: var(--n-footer-border-top);
 transition: border .3s var(--n-bezier);
 padding: var(--n-footer-padding);
 `)]),j("right-placement",`
 top: 0;
 bottom: 0;
 right: 0;
 border-top-left-radius: var(--n-border-radius);
 border-bottom-left-radius: var(--n-border-radius);
 `,[Z("resize-trigger",`
 width: 3px;
 height: 100%;
 top: 0;
 left: 0;
 transform: translateX(-1.5px);
 cursor: ew-resize;
 `)]),j("left-placement",`
 top: 0;
 bottom: 0;
 left: 0;
 border-top-right-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `,[Z("resize-trigger",`
 width: 3px;
 height: 100%;
 top: 0;
 right: 0;
 transform: translateX(1.5px);
 cursor: ew-resize;
 `)]),j("top-placement",`
 top: 0;
 left: 0;
 right: 0;
 border-bottom-left-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `,[Z("resize-trigger",`
 width: 100%;
 height: 3px;
 bottom: 0;
 left: 0;
 transform: translateY(1.5px);
 cursor: ns-resize;
 `)]),j("bottom-placement",`
 left: 0;
 bottom: 0;
 right: 0;
 border-top-left-radius: var(--n-border-radius);
 border-top-right-radius: var(--n-border-radius);
 `,[Z("resize-trigger",`
 width: 100%;
 height: 3px;
 top: 0;
 left: 0;
 transform: translateY(-1.5px);
 cursor: ns-resize;
 `)])]),w("body",[w(">",[O("drawer-container",`
 position: fixed;
 `)])]),O("drawer-container",`
 position: relative;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 `,[w("> *",`
 pointer-events: all;
 `)]),O("drawer-mask",`
 background-color: rgba(0, 0, 0, .3);
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `,[j("invisible",`
 background-color: rgba(0, 0, 0, 0)
 `),dt({enterDuration:"0.2s",leaveDuration:"0.2s",enterCubicBezier:"var(--n-bezier-in)",leaveCubicBezier:"var(--n-bezier-out)"})])]),It=Object.assign(Object.assign({},Te.props),{show:Boolean,width:[Number,String],height:[Number,String],placement:{type:String,default:"right"},maskClosable:{type:Boolean,default:!0},showMask:{type:[Boolean,String],default:!0},to:[String,Object],displayDirective:{type:String,default:"if"},nativeScrollbar:{type:Boolean,default:!0},zIndex:Number,onMaskClick:Function,scrollbarProps:Object,contentClass:String,contentStyle:[Object,String],trapFocus:{type:Boolean,default:!0},onEsc:Function,autoFocus:{type:Boolean,default:!0},closeOnEsc:{type:Boolean,default:!0},blockScroll:{type:Boolean,default:!0},maxWidth:Number,maxHeight:Number,minWidth:Number,minHeight:Number,resizable:Boolean,defaultWidth:{type:[Number,String],default:251},defaultHeight:{type:[Number,String],default:251},onUpdateWidth:[Function,Array],onUpdateHeight:[Function,Array],"onUpdate:width":[Function,Array],"onUpdate:height":[Function,Array],"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onAfterEnter:Function,onAfterLeave:Function,drawerStyle:[String,Object],drawerClass:String,target:null,onShow:Function,onHide:Function}),Ft=V({name:"Drawer",inheritAttrs:!1,props:It,setup(t){const{mergedClsPrefixRef:o,namespaceRef:e,inlineThemeDisabled:m}=Be(t),s=Pe(),d=Te("Drawer","-drawer",Bt,gt,t,o),l=p(t.defaultWidth),h=p(t.defaultHeight),c=Me(Re(t,"width"),l),g=Me(Re(t,"height"),h),$=N(()=>{const{placement:f}=t;return f==="top"||f==="bottom"?"":_e(c.value)}),C=N(()=>{const{placement:f}=t;return f==="left"||f==="right"?"":_e(g.value)}),_=f=>{const{onUpdateWidth:y,"onUpdate:width":M}=t;y&&G(y,f),M&&G(M,f),l.value=f},u=f=>{const{onUpdateHeight:y,"onUpdate:width":M}=t;y&&G(y,f),M&&G(M,f),h.value=f},v=N(()=>[{width:$.value,height:C.value},t.drawerStyle||""]);function I(f){const{onMaskClick:y,maskClosable:M}=t;M&&X(!1),y&&y(f)}function J(f){I(f)}const ee=ut();function te(f){var y;(y=t.onEsc)===null||y===void 0||y.call(t),t.show&&t.closeOnEsc&&ft(f)&&(ee.value||X(!1))}function X(f){const{onHide:y,onUpdateShow:M,"onUpdate:show":b}=t;M&&G(M,f),b&&G(b,f),y&&!f&&G(y,f)}se(be,{isMountedRef:s,mergedThemeRef:d,mergedClsPrefixRef:o,doUpdateShow:X,doUpdateHeight:u,doUpdateWidth:_});const D=N(()=>{const{common:{cubicBezierEaseInOut:f,cubicBezierEaseIn:y,cubicBezierEaseOut:M},self:{color:b,textColor:q,boxShadow:F,lineHeight:T,headerPadding:W,footerPadding:le,borderRadius:ie,bodyPadding:de,titleFontSize:ue,titleTextColor:ce,titleFontWeight:fe,headerBorderBottom:me,footerBorderTop:ve,closeIconColor:he,closeIconColorHover:i,closeIconColorPressed:n,closeColorHover:a,closeColorPressed:R,closeIconSize:z,closeSize:E,closeBorderRadius:Y,resizableTriggerColorHover:Ce}}=d.value;return{"--n-line-height":T,"--n-color":b,"--n-border-radius":ie,"--n-text-color":q,"--n-box-shadow":F,"--n-bezier":f,"--n-bezier-out":M,"--n-bezier-in":y,"--n-header-padding":W,"--n-body-padding":de,"--n-footer-padding":le,"--n-title-text-color":ce,"--n-title-font-size":ue,"--n-title-font-weight":fe,"--n-header-border-bottom":me,"--n-footer-border-top":ve,"--n-close-icon-color":he,"--n-close-icon-color-hover":i,"--n-close-icon-color-pressed":n,"--n-close-size":E,"--n-close-color-hover":a,"--n-close-color-pressed":R,"--n-close-icon-size":z,"--n-close-border-radius":Y,"--n-resize-trigger-color-hover":Ce}}),L=m?Ve("drawer",void 0,D,t):void 0;return{mergedClsPrefix:o,namespace:e,mergedBodyStyle:v,handleOutsideClick:J,handleMaskClick:I,handleEsc:te,mergedTheme:d,cssVars:m?void 0:D,themeClass:L==null?void 0:L.themeClass,onRender:L==null?void 0:L.onRender,isMounted:s}},render(){const{mergedClsPrefix:t}=this;return x(ct,{to:this.to,show:this.show},{default:()=>{var o;return(o=this.onRender)===null||o===void 0||o.call(this),pe(x("div",{class:[`${t}-drawer-container`,this.namespace,this.themeClass],style:this.cssVars,role:"none"},this.showMask?x(Fe,{name:"fade-in-transition",appear:this.isMounted},{default:()=>this.show?x("div",{"aria-hidden":!0,class:[`${t}-drawer-mask`,this.showMask==="transparent"&&`${t}-drawer-mask--invisible`],onClick:this.handleMaskClick}):null}):null,x(bt,Object.assign({},this.$attrs,{class:[this.drawerClass,this.$attrs.class],style:[this.mergedBodyStyle,this.$attrs.style],blockScroll:this.blockScroll,contentStyle:this.contentStyle,contentClass:this.contentClass,placement:this.placement,scrollbarProps:this.scrollbarProps,show:this.show,displayDirective:this.displayDirective,nativeScrollbar:this.nativeScrollbar,onAfterEnter:this.onAfterEnter,onAfterLeave:this.onAfterLeave,trapFocus:this.trapFocus,autoFocus:this.autoFocus,resizable:this.resizable,maxHeight:this.maxHeight,minHeight:this.minHeight,maxWidth:this.maxWidth,minWidth:this.minWidth,showMask:this.showMask,onEsc:this.handleEsc,onClickoutside:this.handleOutsideClick}),this.$slots)),[[mt,{zIndex:this.zIndex,enabled:this.show}]])}})}}),Tt={title:String,headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],bodyClass:String,bodyStyle:[Object,String],bodyContentClass:String,bodyContentStyle:[Object,String],nativeScrollbar:{type:Boolean,default:!0},scrollbarProps:Object,closable:Boolean},Ut=V({name:"DrawerContent",props:Tt,slots:Object,setup(){const t=ze(be,null);t||We("drawer-content","`n-drawer-content` must be placed inside `n-drawer`.");const{doUpdateShow:o}=t;function e(){o(!1)}return{handleCloseClick:e,mergedTheme:t.mergedThemeRef,mergedClsPrefix:t.mergedClsPrefixRef}},render(){const{title:t,mergedClsPrefix:o,nativeScrollbar:e,mergedTheme:m,bodyClass:s,bodyStyle:d,bodyContentClass:l,bodyContentStyle:h,headerClass:c,headerStyle:g,footerClass:$,footerStyle:C,scrollbarProps:_,closable:u,$slots:v}=this;return x("div",{role:"none",class:[`${o}-drawer-content`,e&&`${o}-drawer-content--native-scrollbar`]},v.header||t||u?x("div",{class:[`${o}-drawer-header`,c],style:g,role:"none"},x("div",{class:`${o}-drawer-header__main`,role:"heading","aria-level":"1"},v.header!==void 0?v.header():t),u&&x(vt,{onClick:this.handleCloseClick,clsPrefix:o,class:`${o}-drawer-header__close`,absolute:!0})):null,e?x("div",{class:[`${o}-drawer-body`,s],style:d,role:"none"},x("div",{class:[`${o}-drawer-body-content-wrapper`,l],style:h,role:"none"},v)):x(Ne,Object.assign({themeOverrides:m.peerOverrides.Scrollbar,theme:m.peers.Scrollbar},_,{class:`${o}-drawer-body`,contentClass:[`${o}-drawer-body-content-wrapper`,l],contentStyle:h}),v),v.footer?x("div",{class:[`${o}-drawer-footer`,$],style:C,role:"none"},v.footer()):null)}}),Nt={class:"marker-container"},Et={key:0,class:"marker-label"},Ot=V({__name:"MapMarker",props:{label:{type:String,default:""},color:{type:String,default:"#5D87EE"}},setup(t){return je(o=>({"16b99aed":t.color})),(o,e)=>(k(),U("div",Nt,[Ue(o.$slots,"icon",{},()=>[e[0]||(e[0]=r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z",fill:"currentColor"})],-1))],!0),t.label?(k(),U("div",Et,A(t.label),1)):ae("",!0)]))}}),Dt=K(Ot,[["__scopeId","data-v-6d1feb55"]]),Lt=["disabled"],At=V({__name:"SecondaryButton",props:{disabled:{type:Boolean,default:!1},fullWidth:{type:Boolean,default:!1}},emits:["click"],setup(t){return(o,e)=>(k(),U("button",{class:Xe(["secondary-button",{disabled:t.disabled},{"full-width":t.fullWidth}]),disabled:t.disabled,onClick:e[0]||(e[0]=m=>o.$emit("click",m))},[Ue(o.$slots,"default",{},void 0,!0)],10,Lt))}}),Ht=K(At,[["__scopeId","data-v-0f86604f"]]),Pt={class:"material-counter bg-[var(--color-background)]"},Vt={class:"material-name"},Wt={class:"counter-controls"},jt=["disabled"],Xt={class:"counter-value"},Yt=["disabled"],Zt=V({__name:"MaterialCounter",props:{name:{type:String,required:!0},initialCount:{type:Number,default:1},disabled:{type:Boolean,default:!1}},emits:["update:count"],setup(t,{emit:o}){const e=t,m=o,s=p(Math.max(1,e.initialCount));ge(()=>{e.initialCount<1&&m("update:count",{name:e.name,count:1})}),H(()=>e.initialCount,h=>{s.value=Math.max(1,h)});const d=()=>{s.value++,m("update:count",{name:e.name,count:s.value})},l=()=>{s.value>1&&(s.value--,m("update:count",{name:e.name,count:s.value}))};return(h,c)=>(k(),U("div",Pt,[r("div",Vt,A(t.name),1),r("div",Wt,[r("button",{class:"counter-btn",onClick:d,disabled:t.disabled}," + ",8,jt),r("span",Xt,A(s.value),1),r("button",{class:"counter-btn",onClick:l,disabled:t.disabled||s.value<=1}," - ",8,Yt)])]))}}),Gt=K(Zt,[["__scopeId","data-v-9883e384"]]),Kt={class:"change-movers-form"},Qt={class:"form-group"},Jt={class:"number-input-container"},eo=["disabled"],to={key:0,class:"validation-error"},oo={class:"action-buttons"},no=V({__name:"ChangeMoversModal",props:{show:{type:Boolean,default:!1},initialCount:{type:Number,default:2}},emits:["update:show","confirm","cancel"],setup(t,{emit:o}){const e=t,m=o,s=p(e.show),d=p(e.initialCount.toString()),l=p(!0),h=p(!1);ge(()=>{console.log("ChangeMoversModal mounted with props:",{show:e.show,initialCount:e.initialCount}),c()}),H(()=>e.show,u=>{console.log("show prop changed:",u),s.value=u,u&&(d.value=e.initialCount.toString(),h.value=!1,c(),console.log("Modal opened with initial count:",e.initialCount))}),H(s,u=>{console.log("isModalOpen changed:",u),m("update:show",u)}),H(()=>e.initialCount,u=>{console.log("initialCount prop changed:",u),d.value=u.toString(),c()}),H(d,()=>{c()});const c=()=>{h.value=!0;const u=d.value.trim();if(!u||isNaN(Number(u))){l.value=!1,console.log("Invalid input - not a number:",u);return}const v=parseInt(u);l.value=Number.isInteger(v)&&v>0,console.log("Validated input:",{value:u,parsed:v,isValid:l.value})},g=()=>{const u=parseInt(d.value)||0;d.value=(u+1).toString(),c()},$=()=>{const u=parseInt(d.value)||0;u>1&&(d.value=(u-1).toString(),c())},C=()=>{console.log("Cancel clicked"),s.value=!1,m("cancel")},_=()=>{if(c(),l.value){const u=parseInt(d.value);console.log("Confirm clicked with value:",u),m("confirm",u),s.value=!1}};return(u,v)=>(k(),Q(we,{show:s.value,"onUpdate:show":v[1]||(v[1]=I=>s.value=I),title:"Change number of movers"},{default:B(()=>[r("div",Kt,[r("div",Qt,[v[3]||(v[3]=r("label",null,"New number",-1)),r("div",Jt,[r("button",{type:"button",class:"number-btn decrement",onClick:$,disabled:parseInt(d.value)<=1||!l.value}," - ",8,eo),S(Ee,{modelValue:d.value,"onUpdate:modelValue":v[0]||(v[0]=I=>d.value=I),type:"number",min:"1",inputmode:"numeric",pattern:"[0-9]*",onInput:c,onChange:c,class:"number-input"},null,8,["modelValue"]),r("button",{type:"button",class:"number-btn increment",onClick:g}," + "),v[2]||(v[2]=r("span",{class:"input-label"},"movers",-1))]),!l.value&&h.value?(k(),U("div",to," Please enter a valid number (minimum 1) ")):ae("",!0)]),r("div",oo,[S(ye,{onClick:C},{default:B(()=>v[4]||(v[4]=[P("Cancel")])),_:1}),S(ne,{"small-button":"true",onClick:_,disabled:!l.value},{default:B(()=>v[5]||(v[5]=[P("Confirm")])),_:1},8,["disabled"])])])]),_:1},8,["show"]))}}),so=K(no,[["__scopeId","data-v-ccc25a07"]]),ao={class:"add-material-form"},ro={class:"form-group"},lo={class:"action-buttons"},io=V({__name:"AddMaterialModal",props:{show:{type:Boolean,default:!1}},emits:["update:show","add","cancel"],setup(t,{emit:o}){const e=t,m=o,s=p(e.show),d=p(""),l=p(!1);H(()=>e.show,$=>{s.value=$,$&&(d.value="",h())}),H(s,$=>{m("update:show",$)});const h=()=>{l.value=d.value.trim().length>0},c=()=>{s.value=!1,m("cancel")},g=()=>{l.value&&(m("add",d.value.trim()),s.value=!1)};return($,C)=>(k(),Q(we,{modelValue:s.value,"onUpdate:modelValue":C[1]||(C[1]=_=>s.value=_),title:"Add material"},{default:B(()=>[r("div",ao,[r("div",ro,[C[2]||(C[2]=r("label",null,"Material name",-1)),S(Ee,{modelValue:d.value,"onUpdate:modelValue":C[0]||(C[0]=_=>d.value=_),placeholder:"Type here",onInput:h},null,8,["modelValue"])]),r("div",lo,[S(ye,{onClick:c},{default:B(()=>C[3]||(C[3]=[P("Cancel")])),_:1}),S(ne,{"small-button":"true",onClick:g,disabled:!l.value},{default:B(()=>C[4]||(C[4]=[P("Add")])),_:1},8,["disabled"])])])]),_:1},8,["modelValue"]))}}),uo=K(io,[["__scopeId","data-v-bec6c0ac"]]),co={class:"unload-load-form"},fo={class:"operation-buttons"},mo={class:"cancel-button mt-4"},vo=V({__name:"UnloadLoadModal",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","unload","load","cancel"],setup(t,{emit:o}){const e=t,m=o,s=p(e.modelValue);H(()=>e.modelValue,c=>{s.value=c}),H(s,c=>{m("update:modelValue",c)});const d=()=>{m("unload"),s.value=!1},l=()=>{m("load"),s.value=!1},h=()=>{s.value=!1,m("cancel")};return(c,g)=>(k(),Q(we,{modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=$=>s.value=$),title:"Unload/Load"},{default:B(()=>[r("div",co,[g[4]||(g[4]=r("div",{class:"status-message"},[r("p",null,"Select an operation to perform:")],-1)),r("div",fo,[S(ne,{"small-button":"true",onClick:d,class:"mb-3"},{default:B(()=>g[1]||(g[1]=[P(" Unload at current location ")])),_:1}),S(ne,{"small-button":"true",onClick:l},{default:B(()=>g[2]||(g[2]=[P(" Load from current location ")])),_:1})]),r("div",mo,[S(ye,{onClick:h,class:"w-full"},{default:B(()=>g[3]||(g[3]=[P("Cancel")])),_:1})])])]),_:1},8,["modelValue"]))}}),ho=K(vo,[["__scopeId","data-v-9c92e9d3"]]),po={class:"tracking-view"},go={key:0,class:"flex items-center justify-center h-screen"},bo={key:1,class:"p-4"},wo={class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},yo={key:2,class:"p-4"},Co={key:3,class:"tracking-content"},$o={class:"map-container"},xo={class:"info-window-content"},Ro={class:"text-lg font-semibold"},ko={class:"info-bar"},So={class:"info-item"},Mo={class:"info-value"},qo={class:"info-item"},_o={class:"info-value"},zo={class:"info-item"},Bo={class:"info-value flex items-center"},Io={class:"action-buttons"},Fo={class:"materials-list"},To={key:0,class:"saving-indicator text-blue-500 text-sm mb-2"},Uo=["disabled"],No=V({__name:"TrackingView",setup(t){const o=Ke(),e=Ye(),m=Ze(),s=p(!1),d=p(!1),l=p(""),h=p(!1),c=p(!1),g=p(2),$=p(!1),C=p(!1),_=p(!1),u=p(!1),v=p(!1),I=p(null),J=N(()=>{var n;return(n=e.selectedRequest)!=null&&n.departure_time?new Date(e.selectedRequest.departure_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"}),ee=p("--:--"),te=N(()=>{var i;return(i=e.selectedRequest)!=null&&i.addresses?e.selectedRequest.addresses.map(n=>({id:n.id||n.order,address:n.address,type:n.type,latitude:n.latitude,longitude:n.longitude,visited:!1})):[]}),X=N(()=>{var i;return(i=e.selectedRequest)!=null&&i.materials?e.selectedRequest.materials.map(n=>({id:n.id||Math.random(),name:n.name,count:Math.max(1,n.quantity||1)})):[]}),D=p({lat:40.7128,lng:-74.006}),L=p(12),f=N(()=>{var i;return(i=e.selectedRequest)!=null&&i.addresses?e.selectedRequest.addresses.map(n=>{const a=n.type==="loading",R=parseFloat(n.latitude),z=parseFloat(n.longitude);return{position:{lat:isNaN(R)?40.7128:R,lng:isNaN(z)?-74.006:z},title:a?"Loading Point":"Unloading Point",icon:{url:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(`
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="${a?"#5D87EE":"#F97066"}">
            <path d="M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z"/>
          </svg>
        `)},address:n.address,type:n.type}}):[]}),y=p(null),M=p(!1),b=N(()=>h.value?c.value?"Continue":u.value?"Complete request":"Take a break":"Start moving"),q=async()=>{var i;if((i=e.selectedRequest)!=null&&i.id){s.value=!0;try{h.value?c.value?(await e.updateRequestStatus(e.selectedRequest.id,"active"),c.value=!1):u.value?await F():(await e.updateRequestStatus(e.selectedRequest.id,"break"),c.value=!0):(await e.updateRequestStatus(e.selectedRequest.id,"active"),h.value=!0)}catch(n){console.error("Action error:",n),l.value="Failed to update request status"}finally{s.value=!1}}},F=async()=>{var i;if((i=e.selectedRequest)!=null&&i.id)try{const n={status:"completed",materials:X.value.map(a=>({name:a.name,quantity:Math.max(1,a.count)}))};await e.updateRequest(e.selectedRequest.id,n),o.push("/")}catch(n){console.error("Complete request error:",n),l.value="Failed to complete request"}},T=()=>{console.log("Opening change movers modal, current movers:",g.value),$.value=!0},W=async i=>{var n;if(!((n=e.selectedRequest)!=null&&n.id)){console.error("No request selected for updating movers count");return}console.log(`Updating movers count to: ${i} for request: ${e.selectedRequest.id}`);try{s.value=!0,await e.updateMoversCount(e.selectedRequest.id,i)?(g.value=i,console.log("Movers count updated successfully")):(console.error("Failed to update movers count:",e.error),l.value=`Failed to update movers count: ${e.error||"Unknown error"}`)}catch(a){console.error("Update movers error:",a),l.value="Failed to update movers count"}finally{s.value=!1}},le=async i=>{var a;if(!((a=e.selectedRequest)!=null&&a.id)){console.error("No request selected for adding material");return}e.selectedRequest.materials||(e.selectedRequest.materials=[]),console.log(`Adding material: ${i}`);const n={name:i,quantity:1};e.selectedRequest.materials.push(n),console.log("Materials after adding locally:",e.selectedRequest.materials);try{d.value=!0;const R={materials:e.selectedRequest.materials.map(E=>({name:E.name,quantity:E.quantity||1}))};await e.updateRequest(e.selectedRequest.id,R)?console.log("Material saved successfully to backend"):(console.error("Failed to save material to backend:",e.error),l.value=`Failed to save material: ${e.error||"Unknown error"}`)}catch(R){console.error("Error saving material:",R),l.value="Failed to save material. Please try again."}finally{d.value=!1}},ie=async({name:i,count:n})=>{var R,z;if(!((R=e.selectedRequest)!=null&&R.id)||!((z=e.selectedRequest)!=null&&z.materials)){console.error("No request selected for updating material");return}const a=e.selectedRequest.materials.find(E=>E.name===i);if(a){const E=Math.max(1,n);a.quantity=E,console.log(`Updated material ${i} quantity to ${E}`),I.value&&clearTimeout(I.value),I.value=setTimeout(async()=>{try{d.value=!0;const Y={materials:e.selectedRequest.materials.map($e=>({name:$e.name,quantity:$e.quantity||1}))};await e.updateRequest(e.selectedRequest.id,Y)?console.log("Material quantities saved successfully to backend"):(console.error("Failed to save material quantities to backend:",e.error),l.value=`Failed to save quantity changes: ${e.error||"Unknown error"}`)}catch(Y){console.error("Error saving material quantities:",Y),l.value="Failed to save quantity changes. Please try again."}finally{d.value=!1}},500)}},de=()=>{_.value=!0},ue=()=>{console.log("Unload operation triggered"),u.value=!0},ce=()=>{console.log("Load operation triggered")},fe=()=>{v.value=!v.value},me=()=>{C.value=!0,console.log("Opening add material modal")},ve=i=>{y.value=i,M.value=!0},he=()=>{M.value=!1,y.value=null};return ge(async()=>{var i,n;if(!m.isAuthenticated){o.push("/");return}s.value=!0,l.value="";try{let a=Number(o.currentRoute.value.query.id);if(console.log("TrackingView mounted with query ID:",a),!a&&((i=e.selectedRequest)!=null&&i.id)&&(a=e.selectedRequest.id,console.log(`No ID in URL, using ID from store: ${a}`),o.replace({path:"/tracking",query:{id:a.toString()}})),!a){l.value="No request ID provided. Please select a request first.",console.error("No request ID in URL or store"),s.value=!1;return}if(!e.selectedRequest||e.selectedRequest.id!==a){if(console.log(`Loading request with ID: ${a}`),!await e.getRequestById(a)||!e.selectedRequest){l.value=`Failed to load request #${a}. ${e.error||"Unknown error"}`,console.error("Failed to load request:",e.error),s.value=!1;return}}else console.log("Request already loaded in store:",e.selectedRequest);const R=e.selectedRequest.status||"pending";if(console.log(`Request status: ${R}`),R==="confirmed"?(h.value=!1,c.value=!1):R==="active"?(h.value=!0,c.value=!1):R==="break"&&(h.value=!0,c.value=!0),((n=e.selectedRequest.addresses)==null?void 0:n.length)>0){const z=e.selectedRequest.addresses[0],E=parseFloat(z.latitude),Y=parseFloat(z.longitude);!isNaN(E)&&!isNaN(Y)?(D.value={lat:E,lng:Y},console.log("Map center set to:",D.value)):(console.warn("Invalid coordinates, using default map center"),D.value={lat:40.7128,lng:-74.006})}else console.warn("Request has no addresses, using default map center"),D.value={lat:40.7128,lng:-74.006};g.value=e.selectedRequest.movers_count||2,console.log(`Number of movers: ${g.value}`)}catch(a){console.error("Init tracking error:",a),l.value="An error occurred while loading the request"}finally{s.value=!1}}),H(()=>{var i;return(i=e.selectedRequest)==null?void 0:i.status},(i,n)=>{var a;if(i!==n&&((a=e.selectedRequest)!=null&&a.id)){const R=o.currentRoute.value.query.id,z=e.selectedRequest.id.toString();R!==z&&(console.log(`Updating URL with request ID: ${z}`),o.replace({path:"/tracking",query:{id:z}}))}}),Ie(()=>{if(f.value.length>0&&!y.value){const i=f.value[0];i&&i.position&&(D.value={lat:parseFloat(i.position.lat)||40.7128,lng:parseFloat(i.position.lng)||-74.006})}}),Ge(()=>{I.value&&(clearTimeout(I.value),I.value=null)}),(i,n)=>(k(),U("div",po,[S(Qe,{title:"Tracking"}),s.value?(k(),U("main",go,n[8]||(n[8]=[r("p",null,"Loading tracking data...",-1)]))):l.value?(k(),U("main",bo,[r("div",wo,[r("p",null,A(l.value),1)]),r("button",{onClick:n[0]||(n[0]=a=>oe(o).push("/")),class:"bg-blue-500 text-white px-4 py-2 rounded"}," Return to Requests ")])):oe(e).selectedRequest?(k(),U("main",Co,[r("div",$o,[S(et,{center:D.value,zoom:L.value},{default:B(()=>[(k(!0),U(ke,null,Se(f.value,a=>(k(),Q(Dt,{key:a.title,position:a.position,icon:a.icon,onClick:R=>ve(a)},null,8,["position","icon","onClick"]))),128)),M.value&&y.value?(k(),Q(tt,{key:0,position:y.value.position,onClose:he},{default:B(()=>[r("div",xo,[r("h3",Ro,A(y.value.title),1),r("p",null,A(y.value.address),1)])]),_:1},8,["position"])):ae("",!0)]),_:1},8,["center","zoom"])]),r("div",ko,[r("div",So,[n[10]||(n[10]=r("span",{class:"info-label"},"Departure",-1)),r("span",Mo,A(J.value),1)]),r("div",qo,[n[11]||(n[11]=r("span",{class:"info-label"},"Travel time",-1)),r("span",_o,A(ee.value),1)]),r("div",zo,[n[12]||(n[12]=r("span",{class:"info-label"},"Movers",-1)),r("span",Bo,[P(A(g.value)+" ",1),r("button",{onClick:T,class:"ml-2 text-blue-500 text-xs p-1",type:"button"}," Change ")])])]),r("div",Io,[S(Ht,{onClick:de,disabled:!h.value||c.value},{default:B(()=>[P(A(u.value?"Loading/Unloading complete":"Unload/Load"),1)]),_:1},8,["disabled"]),S(ne,{"small-button":"true",onClick:q,disabled:s.value},{default:B(()=>[P(A(b.value),1)]),_:1},8,["disabled"])]),r("button",{onClick:fe,class:"materials-button"},n[13]||(n[13]=[r("span",null,"Materials",-1)])),S(oe(Ft),{show:v.value,"onUpdate:show":n[2]||(n[2]=a=>v.value=a),placement:"right",width:280},{default:B(()=>[S(oe(Ut),{title:"Materials"},{default:B(()=>[r("div",Fo,[d.value?(k(),U("div",To," Saving changes... ")):ae("",!0),(k(!0),U(ke,null,Se(X.value,a=>(k(),Q(Gt,{key:a.id,name:a.name,initialCount:a.count,"onUpdate:count":ie},null,8,["name","initialCount"]))),128)),r("button",{onClick:me,class:"mt-4 w-full py-2 px-4 bg-blue-100 text-blue-600 rounded-lg",disabled:d.value}," Add New Material ",8,Uo)])]),_:1})]),_:1},8,["show"])])):(k(),U("main",yo,[n[9]||(n[9]=r("p",null,"No request selected. Please select a request first.",-1)),r("button",{onClick:n[1]||(n[1]=a=>oe(o).push("/")),class:"bg-blue-500 text-white px-4 py-2 rounded mt-4"}," Return to Requests ")])),S(so,{show:$.value,"onUpdate:show":n[3]||(n[3]=a=>$.value=a),initialCount:g.value,onConfirm:W,onCancel:n[4]||(n[4]=a=>$.value=!1)},null,8,["show","initialCount"]),S(uo,{show:C.value,"onUpdate:show":n[5]||(n[5]=a=>C.value=a),onAdd:le,onCancel:n[6]||(n[6]=a=>C.value=!1)},null,8,["show"]),S(ho,{show:_.value,"onUpdate:show":n[7]||(n[7]=a=>_.value=a),addresses:te.value,onUnload:ue,onLoad:ce},null,8,["show","addresses"]),S(Je)]))}}),Ao=K(No,[["__scopeId","data-v-6ea290e8"]]);export{Ao as default};
