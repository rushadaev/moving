import{p as Oe,q as De,d as H,r as g,s as ze,c as E,x as Be,y as Le,z as Ie,A as L,B as Ae,C as se,g as ge,D as xe,E as x,T as Te,G as He,I as w,J as re,K as N,L as j,M as Y,N as Ue,O as Pe,P as Re,Q as Ve,R as Z,S as We,U as je,o as R,a as F,V as Fe,e as r,t as D,f as ae,_ as G,W as Xe,l as pe,X as K,h as z,b as k,i as A,k as Ye,u as Ze,Y as Ge,m as oe,j as Ke,H as Qe,Z as ke,$ as Se,F as Je}from"./index-4gi88XVp.js";import{G as et,M as tt}from"./MapInfoWindow-C__ULkwy.js";import{G as ne}from"./GradientButton-DyQeGXpp.js";import{s as ot,d as be,c as nt,u as st,a as at,p as rt,m as lt,F as it,S as Ee,f as dt,b as qe,e as ut,L as ct,g as mt,z as ft,N as vt,M as we,T as Ne,B as ye}from"./Button-DdkkuS5-.js";const ht=/^(\d|\.)+$/,Me=/(\d|\.)+/;function _e(t,{c:o=1,offset:e=0,attachPx:f=!0}={}){if(typeof t=="number"){const s=(t+e)*o;return s===0?"0":`${s}px`}else if(typeof t=="string")if(ht.test(t)){const s=(Number(t)+e)*o;return f?s===0?"0":`${s}px`:`${s}`}else{const s=Me.exec(t);return s?t.replace(Me,String((Number(s[0])+e)*o)):t}return t}function gt(t){const{modalColor:o,textColor1:e,textColor2:f,boxShadow3:s,lineHeight:i,fontWeightStrong:l,dividerColor:h,closeColorHover:u,closeColorPressed:p,closeIconColor:$,closeIconColorHover:C,closeIconColorPressed:M,borderRadius:d,primaryColorHover:v}=t;return{bodyPadding:"16px 24px",borderRadius:d,headerPadding:"16px 24px",footerPadding:"16px 24px",color:o,textColor:f,titleTextColor:e,titleFontSize:"18px",titleFontWeight:l,boxShadow:s,lineHeight:i,headerBorderBottom:`1px solid ${h}`,footerBorderTop:`1px solid ${h}`,closeIconColor:$,closeIconColorHover:C,closeIconColorPressed:M,closeSize:"22px",closeIconSize:"18px",closeColorHover:u,closeColorPressed:p,closeBorderRadius:d,resizableTriggerColorHover:v}}const pt=Oe({name:"Drawer",common:De,peers:{Scrollbar:ot},self:gt}),bt=H({name:"NDrawerContent",inheritAttrs:!1,props:{blockScroll:Boolean,show:{type:Boolean,default:void 0},displayDirective:{type:String,required:!0},placement:{type:String,required:!0},contentClass:String,contentStyle:[Object,String],nativeScrollbar:{type:Boolean,required:!0},scrollbarProps:Object,trapFocus:{type:Boolean,default:!0},autoFocus:{type:Boolean,default:!0},showMask:{type:[Boolean,String],required:!0},maxWidth:Number,maxHeight:Number,minWidth:Number,minHeight:Number,resizable:Boolean,onClickoutside:Function,onAfterLeave:Function,onAfterEnter:Function,onEsc:Function},setup(t){const o=g(!!t.show),e=g(null),f=ze(be);let s=0,i="",l=null;const h=g(!1),u=g(!1),p=E(()=>t.placement==="top"||t.placement==="bottom"),{mergedClsPrefixRef:$,mergedRtlRef:C}=Be(t),M=Le("Drawer",C,$),d=m,v=b=>{u.value=!0,s=p.value?b.clientY:b.clientX,i=document.body.style.cursor,document.body.style.cursor=p.value?"ns-resize":"ew-resize",document.body.addEventListener("mousemove",O),document.body.addEventListener("mouseleave",d),document.body.addEventListener("mouseup",m)},B=()=>{l!==null&&(window.clearTimeout(l),l=null),u.value?h.value=!0:l=window.setTimeout(()=>{h.value=!0},300)},Q=()=>{l!==null&&(window.clearTimeout(l),l=null),h.value=!1},{doUpdateHeight:J,doUpdateWidth:ee}=f,X=b=>{const{maxWidth:q}=t;if(q&&b>q)return q;const{minWidth:I}=t;return I&&b<I?I:b},P=b=>{const{maxHeight:q}=t;if(q&&b>q)return q;const{minHeight:I}=t;return I&&b<I?I:b};function O(b){var q,I;if(u.value)if(p.value){let T=((q=e.value)===null||q===void 0?void 0:q.offsetHeight)||0;const V=s-b.clientY;T+=t.placement==="bottom"?V:-V,T=P(T),J(T),s=b.clientY}else{let T=((I=e.value)===null||I===void 0?void 0:I.offsetWidth)||0;const V=s-b.clientX;T+=t.placement==="right"?V:-V,T=X(T),ee(T),s=b.clientX}}function m(){u.value&&(s=0,u.value=!1,document.body.style.cursor=i,document.body.removeEventListener("mousemove",O),document.body.removeEventListener("mouseup",m),document.body.removeEventListener("mouseleave",d))}Ie(()=>{t.show&&(o.value=!0)}),L(()=>t.show,b=>{b||m()}),Ae(()=>{m()});const y=E(()=>{const{show:b}=t,q=[[xe,b]];return t.showMask||q.push([nt,t.onClickoutside,void 0,{capture:!0}]),q});function S(){var b;o.value=!1,(b=t.onAfterLeave)===null||b===void 0||b.call(t)}return st(E(()=>t.blockScroll&&o.value)),se(at,e),se(rt,null),se(lt,null),{bodyRef:e,rtlEnabled:M,mergedClsPrefix:f.mergedClsPrefixRef,isMounted:f.isMountedRef,mergedTheme:f.mergedThemeRef,displayed:o,transitionName:E(()=>({right:"slide-in-from-right-transition",left:"slide-in-from-left-transition",top:"slide-in-from-top-transition",bottom:"slide-in-from-bottom-transition"})[t.placement]),handleAfterLeave:S,bodyDirectives:y,handleMousedownResizeTrigger:v,handleMouseenterResizeTrigger:B,handleMouseleaveResizeTrigger:Q,isDragging:u,isHoverOnResizeTrigger:h}},render(){const{$slots:t,mergedClsPrefix:o}=this;return this.displayDirective==="show"||this.displayed||this.show?ge(x("div",{role:"none"},x(it,{disabled:!this.showMask||!this.trapFocus,active:this.show,autoFocus:this.autoFocus,onEsc:this.onEsc},{default:()=>x(Te,{name:this.transitionName,appear:this.isMounted,onAfterEnter:this.onAfterEnter,onAfterLeave:this.handleAfterLeave},{default:()=>ge(x("div",He(this.$attrs,{role:"dialog",ref:"bodyRef","aria-modal":"true",class:[`${o}-drawer`,this.rtlEnabled&&`${o}-drawer--rtl`,`${o}-drawer--${this.placement}-placement`,this.isDragging&&`${o}-drawer--unselectable`,this.nativeScrollbar&&`${o}-drawer--native-scrollbar`]}),[this.resizable?x("div",{class:[`${o}-drawer__resize-trigger`,(this.isDragging||this.isHoverOnResizeTrigger)&&`${o}-drawer__resize-trigger--hover`],onMouseenter:this.handleMouseenterResizeTrigger,onMouseleave:this.handleMouseleaveResizeTrigger,onMousedown:this.handleMousedownResizeTrigger}):null,this.nativeScrollbar?x("div",{class:[`${o}-drawer-content-wrapper`,this.contentClass],style:this.contentStyle,role:"none"},t):x(Ee,Object.assign({},this.scrollbarProps,{contentStyle:this.contentStyle,contentClass:[`${o}-drawer-content-wrapper`,this.contentClass],theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar}),t)]),this.bodyDirectives)})})),[[xe,this.displayDirective==="if"||this.displayed||this.show]]):null}}),{cubicBezierEaseIn:wt,cubicBezierEaseOut:yt}=re;function Ct({duration:t="0.3s",leaveDuration:o="0.2s",name:e="slide-in-from-bottom"}={}){return[w(`&.${e}-transition-leave-active`,{transition:`transform ${o} ${wt}`}),w(`&.${e}-transition-enter-active`,{transition:`transform ${t} ${yt}`}),w(`&.${e}-transition-enter-to`,{transform:"translateY(0)"}),w(`&.${e}-transition-enter-from`,{transform:"translateY(100%)"}),w(`&.${e}-transition-leave-from`,{transform:"translateY(0)"}),w(`&.${e}-transition-leave-to`,{transform:"translateY(100%)"})]}const{cubicBezierEaseIn:$t,cubicBezierEaseOut:xt}=re;function Rt({duration:t="0.3s",leaveDuration:o="0.2s",name:e="slide-in-from-left"}={}){return[w(`&.${e}-transition-leave-active`,{transition:`transform ${o} ${$t}`}),w(`&.${e}-transition-enter-active`,{transition:`transform ${t} ${xt}`}),w(`&.${e}-transition-enter-to`,{transform:"translateX(0)"}),w(`&.${e}-transition-enter-from`,{transform:"translateX(-100%)"}),w(`&.${e}-transition-leave-from`,{transform:"translateX(0)"}),w(`&.${e}-transition-leave-to`,{transform:"translateX(-100%)"})]}const{cubicBezierEaseIn:kt,cubicBezierEaseOut:St}=re;function qt({duration:t="0.3s",leaveDuration:o="0.2s",name:e="slide-in-from-right"}={}){return[w(`&.${e}-transition-leave-active`,{transition:`transform ${o} ${kt}`}),w(`&.${e}-transition-enter-active`,{transition:`transform ${t} ${St}`}),w(`&.${e}-transition-enter-to`,{transform:"translateX(0)"}),w(`&.${e}-transition-enter-from`,{transform:"translateX(100%)"}),w(`&.${e}-transition-leave-from`,{transform:"translateX(0)"}),w(`&.${e}-transition-leave-to`,{transform:"translateX(100%)"})]}const{cubicBezierEaseIn:Mt,cubicBezierEaseOut:_t}=re;function zt({duration:t="0.3s",leaveDuration:o="0.2s",name:e="slide-in-from-top"}={}){return[w(`&.${e}-transition-leave-active`,{transition:`transform ${o} ${Mt}`}),w(`&.${e}-transition-enter-active`,{transition:`transform ${t} ${_t}`}),w(`&.${e}-transition-enter-to`,{transform:"translateY(0)"}),w(`&.${e}-transition-enter-from`,{transform:"translateY(-100%)"}),w(`&.${e}-transition-leave-from`,{transform:"translateY(0)"}),w(`&.${e}-transition-leave-to`,{transform:"translateY(-100%)"})]}const Bt=w([N("drawer",`
 word-break: break-word;
 line-height: var(--n-line-height);
 position: absolute;
 pointer-events: all;
 box-shadow: var(--n-box-shadow);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 background-color: var(--n-color);
 color: var(--n-text-color);
 box-sizing: border-box;
 `,[qt(),Rt(),zt(),Ct(),j("unselectable",`
 user-select: none; 
 -webkit-user-select: none;
 `),j("native-scrollbar",[N("drawer-content-wrapper",`
 overflow: auto;
 height: 100%;
 `)]),Y("resize-trigger",`
 position: absolute;
 background-color: #0000;
 transition: background-color .3s var(--n-bezier);
 `,[j("hover",`
 background-color: var(--n-resize-trigger-color-hover);
 `)]),N("drawer-content-wrapper",`
 box-sizing: border-box;
 `),N("drawer-content",`
 height: 100%;
 display: flex;
 flex-direction: column;
 `,[j("native-scrollbar",[N("drawer-body-content-wrapper",`
 height: 100%;
 overflow: auto;
 `)]),N("drawer-body",`
 flex: 1 0 0;
 overflow: hidden;
 `),N("drawer-body-content-wrapper",`
 box-sizing: border-box;
 padding: var(--n-body-padding);
 `),N("drawer-header",`
 font-weight: var(--n-title-font-weight);
 line-height: 1;
 font-size: var(--n-title-font-size);
 color: var(--n-title-text-color);
 padding: var(--n-header-padding);
 transition: border .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-divider-color);
 border-bottom: var(--n-header-border-bottom);
 display: flex;
 justify-content: space-between;
 align-items: center;
 `,[Y("main",`
 flex: 1;
 `),Y("close",`
 margin-left: 6px;
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `)]),N("drawer-footer",`
 display: flex;
 justify-content: flex-end;
 border-top: var(--n-footer-border-top);
 transition: border .3s var(--n-bezier);
 padding: var(--n-footer-padding);
 `)]),j("right-placement",`
 top: 0;
 bottom: 0;
 right: 0;
 border-top-left-radius: var(--n-border-radius);
 border-bottom-left-radius: var(--n-border-radius);
 `,[Y("resize-trigger",`
 width: 3px;
 height: 100%;
 top: 0;
 left: 0;
 transform: translateX(-1.5px);
 cursor: ew-resize;
 `)]),j("left-placement",`
 top: 0;
 bottom: 0;
 left: 0;
 border-top-right-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `,[Y("resize-trigger",`
 width: 3px;
 height: 100%;
 top: 0;
 right: 0;
 transform: translateX(1.5px);
 cursor: ew-resize;
 `)]),j("top-placement",`
 top: 0;
 left: 0;
 right: 0;
 border-bottom-left-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `,[Y("resize-trigger",`
 width: 100%;
 height: 3px;
 bottom: 0;
 left: 0;
 transform: translateY(1.5px);
 cursor: ns-resize;
 `)]),j("bottom-placement",`
 left: 0;
 bottom: 0;
 right: 0;
 border-top-left-radius: var(--n-border-radius);
 border-top-right-radius: var(--n-border-radius);
 `,[Y("resize-trigger",`
 width: 100%;
 height: 3px;
 top: 0;
 left: 0;
 transform: translateY(-1.5px);
 cursor: ns-resize;
 `)])]),w("body",[w(">",[N("drawer-container",`
 position: fixed;
 `)])]),N("drawer-container",`
 position: relative;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 `,[w("> *",`
 pointer-events: all;
 `)]),N("drawer-mask",`
 background-color: rgba(0, 0, 0, .3);
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `,[j("invisible",`
 background-color: rgba(0, 0, 0, 0)
 `),dt({enterDuration:"0.2s",leaveDuration:"0.2s",enterCubicBezier:"var(--n-bezier-in)",leaveCubicBezier:"var(--n-bezier-out)"})])]),It=Object.assign(Object.assign({},Ue.props),{show:Boolean,width:[Number,String],height:[Number,String],placement:{type:String,default:"right"},maskClosable:{type:Boolean,default:!0},showMask:{type:[Boolean,String],default:!0},to:[String,Object],displayDirective:{type:String,default:"if"},nativeScrollbar:{type:Boolean,default:!0},zIndex:Number,onMaskClick:Function,scrollbarProps:Object,contentClass:String,contentStyle:[Object,String],trapFocus:{type:Boolean,default:!0},onEsc:Function,autoFocus:{type:Boolean,default:!0},closeOnEsc:{type:Boolean,default:!0},blockScroll:{type:Boolean,default:!0},maxWidth:Number,maxHeight:Number,minWidth:Number,minHeight:Number,resizable:Boolean,defaultWidth:{type:[Number,String],default:251},defaultHeight:{type:[Number,String],default:251},onUpdateWidth:[Function,Array],onUpdateHeight:[Function,Array],"onUpdate:width":[Function,Array],"onUpdate:height":[Function,Array],"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onAfterEnter:Function,onAfterLeave:Function,drawerStyle:[String,Object],drawerClass:String,target:null,onShow:Function,onHide:Function}),Tt=H({name:"Drawer",inheritAttrs:!1,props:It,setup(t){const{mergedClsPrefixRef:o,namespaceRef:e,inlineThemeDisabled:f}=Be(t),s=Pe(),i=Ue("Drawer","-drawer",Bt,pt,t,o),l=g(t.defaultWidth),h=g(t.defaultHeight),u=qe(Re(t,"width"),l),p=qe(Re(t,"height"),h),$=E(()=>{const{placement:m}=t;return m==="top"||m==="bottom"?"":_e(u.value)}),C=E(()=>{const{placement:m}=t;return m==="left"||m==="right"?"":_e(p.value)}),M=m=>{const{onUpdateWidth:y,"onUpdate:width":S}=t;y&&Z(y,m),S&&Z(S,m),l.value=m},d=m=>{const{onUpdateHeight:y,"onUpdate:width":S}=t;y&&Z(y,m),S&&Z(S,m),h.value=m},v=E(()=>[{width:$.value,height:C.value},t.drawerStyle||""]);function B(m){const{onMaskClick:y,maskClosable:S}=t;S&&X(!1),y&&y(m)}function Q(m){B(m)}const J=ut();function ee(m){var y;(y=t.onEsc)===null||y===void 0||y.call(t),t.show&&t.closeOnEsc&&mt(m)&&(J.value||X(!1))}function X(m){const{onHide:y,onUpdateShow:S,"onUpdate:show":b}=t;S&&Z(S,m),b&&Z(b,m),y&&!m&&Z(y,m)}se(be,{isMountedRef:s,mergedThemeRef:i,mergedClsPrefixRef:o,doUpdateShow:X,doUpdateHeight:d,doUpdateWidth:M});const P=E(()=>{const{common:{cubicBezierEaseInOut:m,cubicBezierEaseIn:y,cubicBezierEaseOut:S},self:{color:b,textColor:q,boxShadow:I,lineHeight:T,headerPadding:V,footerPadding:le,borderRadius:ie,bodyPadding:de,titleFontSize:ue,titleTextColor:ce,titleFontWeight:me,headerBorderBottom:fe,footerBorderTop:ve,closeIconColor:he,closeIconColorHover:c,closeIconColorPressed:n,closeColorHover:a,closeColorPressed:_,closeIconSize:U,closeSize:W,closeBorderRadius:te,resizableTriggerColorHover:Ce}}=i.value;return{"--n-line-height":T,"--n-color":b,"--n-border-radius":ie,"--n-text-color":q,"--n-box-shadow":I,"--n-bezier":m,"--n-bezier-out":S,"--n-bezier-in":y,"--n-header-padding":V,"--n-body-padding":de,"--n-footer-padding":le,"--n-title-text-color":ce,"--n-title-font-size":ue,"--n-title-font-weight":me,"--n-header-border-bottom":fe,"--n-footer-border-top":ve,"--n-close-icon-color":he,"--n-close-icon-color-hover":c,"--n-close-icon-color-pressed":n,"--n-close-size":W,"--n-close-color-hover":a,"--n-close-color-pressed":_,"--n-close-icon-size":U,"--n-close-border-radius":te,"--n-resize-trigger-color-hover":Ce}}),O=f?Ve("drawer",void 0,P,t):void 0;return{mergedClsPrefix:o,namespace:e,mergedBodyStyle:v,handleOutsideClick:Q,handleMaskClick:B,handleEsc:ee,mergedTheme:i,cssVars:f?void 0:P,themeClass:O==null?void 0:O.themeClass,onRender:O==null?void 0:O.onRender,isMounted:s}},render(){const{mergedClsPrefix:t}=this;return x(ct,{to:this.to,show:this.show},{default:()=>{var o;return(o=this.onRender)===null||o===void 0||o.call(this),ge(x("div",{class:[`${t}-drawer-container`,this.namespace,this.themeClass],style:this.cssVars,role:"none"},this.showMask?x(Te,{name:"fade-in-transition",appear:this.isMounted},{default:()=>this.show?x("div",{"aria-hidden":!0,class:[`${t}-drawer-mask`,this.showMask==="transparent"&&`${t}-drawer-mask--invisible`],onClick:this.handleMaskClick}):null}):null,x(bt,Object.assign({},this.$attrs,{class:[this.drawerClass,this.$attrs.class],style:[this.mergedBodyStyle,this.$attrs.style],blockScroll:this.blockScroll,contentStyle:this.contentStyle,contentClass:this.contentClass,placement:this.placement,scrollbarProps:this.scrollbarProps,show:this.show,displayDirective:this.displayDirective,nativeScrollbar:this.nativeScrollbar,onAfterEnter:this.onAfterEnter,onAfterLeave:this.onAfterLeave,trapFocus:this.trapFocus,autoFocus:this.autoFocus,resizable:this.resizable,maxHeight:this.maxHeight,minHeight:this.minHeight,maxWidth:this.maxWidth,minWidth:this.minWidth,showMask:this.showMask,onEsc:this.handleEsc,onClickoutside:this.handleOutsideClick}),this.$slots)),[[ft,{zIndex:this.zIndex,enabled:this.show}]])}})}}),Ut={title:String,headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],bodyClass:String,bodyStyle:[Object,String],bodyContentClass:String,bodyContentStyle:[Object,String],nativeScrollbar:{type:Boolean,default:!0},scrollbarProps:Object,closable:Boolean},Ft=H({name:"DrawerContent",props:Ut,slots:Object,setup(){const t=ze(be,null);t||We("drawer-content","`n-drawer-content` must be placed inside `n-drawer`.");const{doUpdateShow:o}=t;function e(){o(!1)}return{handleCloseClick:e,mergedTheme:t.mergedThemeRef,mergedClsPrefix:t.mergedClsPrefixRef}},render(){const{title:t,mergedClsPrefix:o,nativeScrollbar:e,mergedTheme:f,bodyClass:s,bodyStyle:i,bodyContentClass:l,bodyContentStyle:h,headerClass:u,headerStyle:p,footerClass:$,footerStyle:C,scrollbarProps:M,closable:d,$slots:v}=this;return x("div",{role:"none",class:[`${o}-drawer-content`,e&&`${o}-drawer-content--native-scrollbar`]},v.header||t||d?x("div",{class:[`${o}-drawer-header`,u],style:p,role:"none"},x("div",{class:`${o}-drawer-header__main`,role:"heading","aria-level":"1"},v.header!==void 0?v.header():t),d&&x(vt,{onClick:this.handleCloseClick,clsPrefix:o,class:`${o}-drawer-header__close`,absolute:!0})):null,e?x("div",{class:[`${o}-drawer-body`,s],style:i,role:"none"},x("div",{class:[`${o}-drawer-body-content-wrapper`,l],style:h,role:"none"},v)):x(Ee,Object.assign({themeOverrides:f.peerOverrides.Scrollbar,theme:f.peers.Scrollbar},M,{class:`${o}-drawer-body`,contentClass:[`${o}-drawer-body-content-wrapper`,l],contentStyle:h}),v),v.footer?x("div",{class:[`${o}-drawer-footer`,$],style:C,role:"none"},v.footer()):null)}}),Et={class:"marker-container"},Nt={key:0,class:"marker-label"},Ot=H({__name:"MapMarker",props:{label:{type:String,default:""},color:{type:String,default:"#5D87EE"}},setup(t){return je(o=>({"16b99aed":t.color})),(o,e)=>(R(),F("div",Et,[Fe(o.$slots,"icon",{},()=>[e[0]||(e[0]=r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z",fill:"currentColor"})],-1))],!0),t.label?(R(),F("div",Nt,D(t.label),1)):ae("",!0)]))}}),Dt=G(Ot,[["__scopeId","data-v-6d1feb55"]]),Lt=["disabled"],At=H({__name:"SecondaryButton",props:{disabled:{type:Boolean,default:!1},fullWidth:{type:Boolean,default:!1}},emits:["click"],setup(t){return(o,e)=>(R(),F("button",{class:Xe(["secondary-button",{disabled:t.disabled},{"full-width":t.fullWidth}]),disabled:t.disabled,onClick:e[0]||(e[0]=f=>o.$emit("click",f))},[Fe(o.$slots,"default",{},void 0,!0)],10,Lt))}}),Ht=G(At,[["__scopeId","data-v-0f86604f"]]),Pt={class:"material-counter bg-[var(--color-background)]"},Vt={class:"material-name"},Wt={class:"counter-controls"},jt=["disabled"],Xt={class:"counter-value"},Yt=["disabled"],Zt=H({__name:"MaterialCounter",props:{name:{type:String,required:!0},initialCount:{type:Number,default:1},disabled:{type:Boolean,default:!1}},emits:["update:count"],setup(t,{emit:o}){const e=t,f=o,s=g(Math.max(1,e.initialCount));pe(()=>{e.initialCount<1&&f("update:count",{name:e.name,count:1})}),L(()=>e.initialCount,h=>{s.value=Math.max(1,h)});const i=()=>{s.value++,f("update:count",{name:e.name,count:s.value})},l=()=>{s.value>1&&(s.value--,f("update:count",{name:e.name,count:s.value}))};return(h,u)=>(R(),F("div",Pt,[r("div",Vt,D(t.name),1),r("div",Wt,[r("button",{class:"counter-btn",onClick:i,disabled:t.disabled}," + ",8,jt),r("span",Xt,D(s.value),1),r("button",{class:"counter-btn",onClick:l,disabled:t.disabled||s.value<=1}," - ",8,Yt)])]))}}),Gt=G(Zt,[["__scopeId","data-v-9883e384"]]),Kt={class:"change-movers-form"},Qt={class:"form-group"},Jt={class:"number-input-container"},eo=["disabled"],to={key:0,class:"validation-error"},oo={class:"action-buttons"},no=H({__name:"ChangeMoversModal",props:{show:{type:Boolean,default:!1},initialCount:{type:Number,default:2}},emits:["update:show","confirm","cancel"],setup(t,{emit:o}){const e=t,f=o,s=g(e.show),i=g(e.initialCount.toString()),l=g(!0),h=g(!1);pe(()=>{console.log("ChangeMoversModal mounted with props:",{show:e.show,initialCount:e.initialCount}),u()}),L(()=>e.show,d=>{console.log("show prop changed:",d),s.value=d,d&&(i.value=e.initialCount.toString(),h.value=!1,u(),console.log("Modal opened with initial count:",e.initialCount))}),L(s,d=>{console.log("isModalOpen changed:",d),f("update:show",d)}),L(()=>e.initialCount,d=>{console.log("initialCount prop changed:",d),i.value=d.toString(),u()}),L(i,()=>{u()});const u=()=>{h.value=!0;const d=i.value.trim();if(!d||isNaN(Number(d))){l.value=!1,console.log("Invalid input - not a number:",d);return}const v=parseInt(d);l.value=Number.isInteger(v)&&v>0,console.log("Validated input:",{value:d,parsed:v,isValid:l.value})},p=()=>{const d=parseInt(i.value)||0;i.value=(d+1).toString(),u()},$=()=>{const d=parseInt(i.value)||0;d>1&&(i.value=(d-1).toString(),u())},C=()=>{console.log("Cancel clicked"),s.value=!1,f("cancel")},M=()=>{if(u(),l.value){const d=parseInt(i.value);console.log("Confirm clicked with value:",d),f("confirm",d),s.value=!1}};return(d,v)=>(R(),K(we,{show:s.value,"onUpdate:show":v[1]||(v[1]=B=>s.value=B),title:"Change number of movers"},{default:z(()=>[r("div",Kt,[r("div",Qt,[v[3]||(v[3]=r("label",null,"New number",-1)),r("div",Jt,[r("button",{type:"button",class:"number-btn decrement",onClick:$,disabled:parseInt(i.value)<=1||!l.value}," - ",8,eo),k(Ne,{modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=B=>i.value=B),type:"number",min:"1",inputmode:"numeric",pattern:"[0-9]*",onInput:u,onChange:u,class:"number-input"},null,8,["modelValue"]),r("button",{type:"button",class:"number-btn increment",onClick:p}," + "),v[2]||(v[2]=r("span",{class:"input-label"},"movers",-1))]),!l.value&&h.value?(R(),F("div",to," Please enter a valid number (minimum 1) ")):ae("",!0)]),r("div",oo,[k(ye,{onClick:C},{default:z(()=>v[4]||(v[4]=[A("Cancel")])),_:1}),k(ne,{"small-button":"true",onClick:M,disabled:!l.value},{default:z(()=>v[5]||(v[5]=[A("Confirm")])),_:1},8,["disabled"])])])]),_:1},8,["show"]))}}),so=G(no,[["__scopeId","data-v-ccc25a07"]]),ao={class:"add-material-form"},ro={class:"form-group"},lo={class:"action-buttons"},io=H({__name:"AddMaterialModal",props:{show:{type:Boolean,default:!1}},emits:["update:show","add","cancel"],setup(t,{emit:o}){const e=t,f=o,s=g(e.show),i=g(""),l=g(!1);L(()=>e.show,$=>{s.value=$,$&&(i.value="",h())}),L(s,$=>{f("update:show",$)});const h=()=>{l.value=i.value.trim().length>0},u=()=>{s.value=!1,f("cancel")},p=()=>{l.value&&(f("add",i.value.trim()),s.value=!1)};return($,C)=>(R(),K(we,{modelValue:s.value,"onUpdate:modelValue":C[1]||(C[1]=M=>s.value=M),title:"Add material"},{default:z(()=>[r("div",ao,[r("div",ro,[C[2]||(C[2]=r("label",null,"Material name",-1)),k(Ne,{modelValue:i.value,"onUpdate:modelValue":C[0]||(C[0]=M=>i.value=M),placeholder:"Type here",onInput:h},null,8,["modelValue"])]),r("div",lo,[k(ye,{onClick:u},{default:z(()=>C[3]||(C[3]=[A("Cancel")])),_:1}),k(ne,{"small-button":"true",onClick:p,disabled:!l.value},{default:z(()=>C[4]||(C[4]=[A("Add")])),_:1},8,["disabled"])])])]),_:1},8,["modelValue"]))}}),uo=G(io,[["__scopeId","data-v-bec6c0ac"]]),co={class:"unload-load-form"},mo={class:"operation-buttons"},fo={class:"cancel-button mt-4"},vo=H({__name:"UnloadLoadModal",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","unload","load","cancel"],setup(t,{emit:o}){const e=t,f=o,s=g(e.modelValue);L(()=>e.modelValue,u=>{s.value=u}),L(s,u=>{f("update:modelValue",u)});const i=()=>{f("unload"),s.value=!1},l=()=>{f("load"),s.value=!1},h=()=>{s.value=!1,f("cancel")};return(u,p)=>(R(),K(we,{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=$=>s.value=$),title:"Unload/Load"},{default:z(()=>[r("div",co,[p[4]||(p[4]=r("div",{class:"status-message"},[r("p",null,"Select an operation to perform:")],-1)),r("div",mo,[k(ne,{"small-button":"true",onClick:i,class:"mb-3"},{default:z(()=>p[1]||(p[1]=[A(" Unload at current location ")])),_:1}),k(ne,{"small-button":"true",onClick:l},{default:z(()=>p[2]||(p[2]=[A(" Load from current location ")])),_:1})]),r("div",fo,[k(ye,{onClick:h,class:"w-full"},{default:z(()=>p[3]||(p[3]=[A("Cancel")])),_:1})])])]),_:1},8,["modelValue"]))}}),ho=G(vo,[["__scopeId","data-v-9c92e9d3"]]),go={class:"tracking-view"},po={key:0,class:"flex items-center justify-center h-screen"},bo={key:1,class:"p-4"},wo={class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},yo={key:2,class:"p-4"},Co={key:3,class:"tracking-content"},$o={class:"map-container"},xo={class:"info-window-content"},Ro={class:"text-lg font-semibold"},ko={class:"info-bar"},So={class:"info-item"},qo={class:"info-value"},Mo={class:"info-item"},_o={class:"info-value"},zo={class:"info-item"},Bo={class:"info-value flex items-center"},Io={class:"action-buttons"},To={class:"materials-list"},Uo={key:0,class:"saving-indicator text-blue-500 text-sm mb-2"},Fo=["disabled"],Eo=H({__name:"TrackingView",setup(t){const o=Ke(),e=Ye(),f=Ze(),s=g(!1),i=g(!1),l=g(""),h=g(!1),u=g(!1),p=g(2),$=g(!1),C=g(!1),M=g(!1),d=g(!1),v=g(!1),B=g(null),Q=E(()=>{var n;return(n=e.selectedRequest)!=null&&n.departure_time?new Date(e.selectedRequest.departure_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"}),J=g("--:--"),ee=E(()=>{var c;return(c=e.selectedRequest)!=null&&c.addresses?e.selectedRequest.addresses.map(n=>({id:n.id||n.order,address:n.address,type:n.type,latitude:n.latitude,longitude:n.longitude,visited:!1})):[]}),X=E(()=>{var c;return(c=e.selectedRequest)!=null&&c.materials?e.selectedRequest.materials.map(n=>({id:n.id||Math.random(),name:n.name,count:Math.max(1,n.quantity||1)})):[]}),P=g({lat:40.7128,lng:-74.006}),O=g(12),m=E(()=>{var c;return(c=e.selectedRequest)!=null&&c.addresses?e.selectedRequest.addresses.map(n=>{const a=n.type==="loading";return{position:{lat:n.latitude,lng:n.longitude},title:a?"Loading Point":"Unloading Point",icon:{url:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(`
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="${a?"#5D87EE":"#F97066"}">
            <path d="M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z"/>
          </svg>
        `)},address:n.address,type:n.type}}):[]}),y=g(null),S=g(!1),b=E(()=>h.value?u.value?"Continue":d.value?"Complete request":"Take a break":"Start moving"),q=async()=>{var c;if((c=e.selectedRequest)!=null&&c.id){s.value=!0;try{h.value?u.value?(await e.updateRequestStatus(e.selectedRequest.id,"active"),u.value=!1):d.value?await I():(await e.updateRequestStatus(e.selectedRequest.id,"break"),u.value=!0):(await e.updateRequestStatus(e.selectedRequest.id,"active"),h.value=!0)}catch(n){console.error("Action error:",n),l.value="Failed to update request status"}finally{s.value=!1}}},I=async()=>{var c;if((c=e.selectedRequest)!=null&&c.id)try{const n={status:"completed",materials:X.value.map(a=>({name:a.name,quantity:Math.max(1,a.count)}))};await e.updateRequest(e.selectedRequest.id,n),o.push("/")}catch(n){console.error("Complete request error:",n),l.value="Failed to complete request"}},T=()=>{console.log("Opening change movers modal, current movers:",p.value),$.value=!0},V=async c=>{var n;if(!((n=e.selectedRequest)!=null&&n.id)){console.error("No request selected for updating movers count");return}console.log(`Updating movers count to: ${c} for request: ${e.selectedRequest.id}`);try{s.value=!0,await e.updateMoversCount(e.selectedRequest.id,c)?(p.value=c,console.log("Movers count updated successfully")):(console.error("Failed to update movers count:",e.error),l.value=`Failed to update movers count: ${e.error||"Unknown error"}`)}catch(a){console.error("Update movers error:",a),l.value="Failed to update movers count"}finally{s.value=!1}},le=async c=>{var a;if(!((a=e.selectedRequest)!=null&&a.id)){console.error("No request selected for adding material");return}e.selectedRequest.materials||(e.selectedRequest.materials=[]),console.log(`Adding material: ${c}`);const n={name:c,quantity:1};e.selectedRequest.materials.push(n),console.log("Materials after adding locally:",e.selectedRequest.materials);try{i.value=!0;const _={materials:e.selectedRequest.materials.map(W=>({name:W.name,quantity:W.quantity||1}))};await e.updateRequest(e.selectedRequest.id,_)?console.log("Material saved successfully to backend"):(console.error("Failed to save material to backend:",e.error),l.value=`Failed to save material: ${e.error||"Unknown error"}`)}catch(_){console.error("Error saving material:",_),l.value="Failed to save material. Please try again."}finally{i.value=!1}},ie=async({name:c,count:n})=>{var _,U;if(!((_=e.selectedRequest)!=null&&_.id)||!((U=e.selectedRequest)!=null&&U.materials)){console.error("No request selected for updating material");return}const a=e.selectedRequest.materials.find(W=>W.name===c);if(a){const W=Math.max(1,n);a.quantity=W,console.log(`Updated material ${c} quantity to ${W}`),B.value&&clearTimeout(B.value),B.value=setTimeout(async()=>{try{i.value=!0;const te={materials:e.selectedRequest.materials.map($e=>({name:$e.name,quantity:$e.quantity||1}))};await e.updateRequest(e.selectedRequest.id,te)?console.log("Material quantities saved successfully to backend"):(console.error("Failed to save material quantities to backend:",e.error),l.value=`Failed to save quantity changes: ${e.error||"Unknown error"}`)}catch(te){console.error("Error saving material quantities:",te),l.value="Failed to save quantity changes. Please try again."}finally{i.value=!1}},500)}},de=()=>{M.value=!0},ue=()=>{console.log("Unload operation triggered"),d.value=!0},ce=()=>{console.log("Load operation triggered")},me=()=>{v.value=!v.value},fe=()=>{C.value=!0,console.log("Opening add material modal")},ve=c=>{y.value=c,S.value=!0},he=()=>{S.value=!1,y.value=null};return pe(async()=>{var c,n;if(!f.isAuthenticated){o.push("/");return}s.value=!0,l.value="";try{let a=Number(o.currentRoute.value.query.id);if(console.log("TrackingView mounted with query ID:",a),!a&&((c=e.selectedRequest)!=null&&c.id)&&(a=e.selectedRequest.id,console.log(`No ID in URL, using ID from store: ${a}`),o.replace({path:"/tracking",query:{id:a.toString()}})),!a){l.value="No request ID provided. Please select a request first.",console.error("No request ID in URL or store"),s.value=!1;return}if(!e.selectedRequest||e.selectedRequest.id!==a){if(console.log(`Loading request with ID: ${a}`),!await e.getRequestById(a)||!e.selectedRequest){l.value=`Failed to load request #${a}. ${e.error||"Unknown error"}`,console.error("Failed to load request:",e.error),s.value=!1;return}}else console.log("Request already loaded in store:",e.selectedRequest);const _=e.selectedRequest.status||"pending";if(console.log(`Request status: ${_}`),_==="confirmed"?(h.value=!1,u.value=!1):_==="active"?(h.value=!0,u.value=!1):_==="break"&&(h.value=!0,u.value=!0),((n=e.selectedRequest.addresses)==null?void 0:n.length)>0){const U=e.selectedRequest.addresses[0];P.value={lat:U.latitude,lng:U.longitude},console.log("Map center set to:",P.value)}else console.warn("Request has no addresses, using default map center");p.value=e.selectedRequest.movers_count||2,console.log(`Number of movers: ${p.value}`)}catch(a){console.error("Init tracking error:",a),l.value="An error occurred while loading the request"}finally{s.value=!1}}),L(()=>{var c;return(c=e.selectedRequest)==null?void 0:c.status},(c,n)=>{var a;if(c!==n&&((a=e.selectedRequest)!=null&&a.id)){const _=o.currentRoute.value.query.id,U=e.selectedRequest.id.toString();_!==U&&(console.log(`Updating URL with request ID: ${U}`),o.replace({path:"/tracking",query:{id:U}}))}}),Ie(()=>{m.value.length>0&&!y.value&&(P.value=m.value[0].position)}),Ge(()=>{B.value&&(clearTimeout(B.value),B.value=null)}),(c,n)=>(R(),F("div",go,[k(Qe,{title:"Tracking"}),s.value?(R(),F("main",po,n[8]||(n[8]=[r("p",null,"Loading tracking data...",-1)]))):l.value?(R(),F("main",bo,[r("div",wo,[r("p",null,D(l.value),1)]),r("button",{onClick:n[0]||(n[0]=a=>oe(o).push("/")),class:"bg-blue-500 text-white px-4 py-2 rounded"}," Return to Requests ")])):oe(e).selectedRequest?(R(),F("main",Co,[r("div",$o,[k(et,{center:P.value,zoom:O.value},{default:z(()=>[(R(!0),F(ke,null,Se(m.value,a=>(R(),K(Dt,{key:a.title,position:a.position,icon:a.icon,onClick:_=>ve(a)},null,8,["position","icon","onClick"]))),128)),S.value&&y.value?(R(),K(tt,{key:0,position:y.value.position,onClose:he},{default:z(()=>[r("div",xo,[r("h3",Ro,D(y.value.title),1),r("p",null,D(y.value.address),1)])]),_:1},8,["position"])):ae("",!0)]),_:1},8,["center","zoom"])]),r("div",ko,[r("div",So,[n[10]||(n[10]=r("span",{class:"info-label"},"Departure",-1)),r("span",qo,D(Q.value),1)]),r("div",Mo,[n[11]||(n[11]=r("span",{class:"info-label"},"Travel time",-1)),r("span",_o,D(J.value),1)]),r("div",zo,[n[12]||(n[12]=r("span",{class:"info-label"},"Movers",-1)),r("span",Bo,[A(D(p.value)+" ",1),r("button",{onClick:T,class:"ml-2 text-blue-500 text-xs p-1",type:"button"}," Change ")])])]),r("div",Io,[k(Ht,{onClick:de,disabled:!h.value||u.value},{default:z(()=>[A(D(d.value?"Loading/Unloading complete":"Unload/Load"),1)]),_:1},8,["disabled"]),k(ne,{"small-button":"true",onClick:q,disabled:s.value},{default:z(()=>[A(D(b.value),1)]),_:1},8,["disabled"])]),r("button",{onClick:me,class:"materials-button"},n[13]||(n[13]=[r("span",null,"Materials",-1)])),k(oe(Tt),{show:v.value,"onUpdate:show":n[2]||(n[2]=a=>v.value=a),placement:"right",width:280},{default:z(()=>[k(oe(Ft),{title:"Materials"},{default:z(()=>[r("div",To,[i.value?(R(),F("div",Uo," Saving changes... ")):ae("",!0),(R(!0),F(ke,null,Se(X.value,a=>(R(),K(Gt,{key:a.id,name:a.name,initialCount:a.count,"onUpdate:count":ie},null,8,["name","initialCount"]))),128)),r("button",{onClick:fe,class:"mt-4 w-full py-2 px-4 bg-blue-100 text-blue-600 rounded-lg",disabled:i.value}," Add New Material ",8,Fo)])]),_:1})]),_:1},8,["show"])])):(R(),F("main",yo,[n[9]||(n[9]=r("p",null,"No request selected. Please select a request first.",-1)),r("button",{onClick:n[1]||(n[1]=a=>oe(o).push("/")),class:"bg-blue-500 text-white px-4 py-2 rounded mt-4"}," Return to Requests ")])),k(so,{show:$.value,"onUpdate:show":n[3]||(n[3]=a=>$.value=a),initialCount:p.value,onConfirm:V,onCancel:n[4]||(n[4]=a=>$.value=!1)},null,8,["show","initialCount"]),k(uo,{show:C.value,"onUpdate:show":n[5]||(n[5]=a=>C.value=a),onAdd:le,onCancel:n[6]||(n[6]=a=>C.value=!1)},null,8,["show"]),k(ho,{show:M.value,"onUpdate:show":n[7]||(n[7]=a=>M.value=a),addresses:ee.value,onUnload:ue,onLoad:ce},null,8,["show","addresses"]),k(Je)]))}}),Ao=G(Eo,[["__scopeId","data-v-471a01c5"]]);export{Ao as default};
